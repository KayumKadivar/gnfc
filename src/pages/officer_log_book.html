<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Officer's Logbook | GNFC</title>

  <link rel="stylesheet" href="/src/css/ios-fonts.css">
  <link rel="stylesheet" href="/src/css/modal-ui.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
  <script src="/src/js/tailwind_config.js"></script>
  <script>
    window.activePage = 'shift_logbook_officer';
  </script>

  <link rel="stylesheet" href="/src/css/typography.css">

  <style>
    /* ===== PLANT CARD ===== */
    .plant-card {
      background: rgba(15, 23, 42, 0.26);
      border: 1px solid rgba(148, 163, 184, 0.22);
      border: 3px solid #5794F2;
      transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
    }

    .plant-card:hover {
      transform: translateY(-2px);
      border-color: rgba(87, 148, 242, 0.45);
      border: #5794F2;
      box-shadow: 0 8px 18px rgba(2, 6, 23, 0.2);
    }

    .plant-card-title {
      font-size: 1.05rem;
      font-weight: 700;
      line-height: 1.2;
      letter-spacing: 0.01em;
      color: var(--app-text, #e6edf3);
    }

    .plant-card-subtitle {
      font-size: 0.68rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--app-muted, #9aa7b5);
    }

    .plant-card-action {
      color: var(--app-muted, #9aa7b5);
      transition: color 0.2s ease;
    }

    .plant-card:hover .plant-card-action {
      color: #5794F2;
    }

    /* Light mode */
    html[data-theme-mode="light"] .plant-card {
      background: #ffffff !important;
      border: 2px solid #cbd5e1 !important;
      box-shadow: 0 1px 2px rgba(15, 23, 42, 0.08);
    }

    html[data-theme-mode="light"] .plant-card:hover {
      border: 2px solid #5794F2 !important;
    }

    html[data-theme-mode="light"] .plant-card-subtitle {
      color: #64748b;
    }

    /* ===== FADE IN ANIMATION ===== */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>

</head>

<body class="bg-dark-bg color-primary font-sans h-screen flex overflow-hidden">

  <script src="/src/js/theme_manager.js"></script>
  <script src="/src/js/sidebar.js"></script>
  <script src="/src/js/elogbook_store.js"></script>
  <div id="sidebar-container"></div>
  <script>renderSidebar('shift_logbook_officer');</script>

  <main class="flex-1 flex flex-col h-screen overflow-hidden">

    <div id="header-container"></div>
    <script src="/src/js/header.js"></script>
    <script>
      renderHeader({
        title: "Officer's Logbook",
        breadcrumbs: [
          { label: "Officer's Logbook" }
        ],
        backLink: "/index.html"
      });
    </script>


    <div class="flex-1 overflow-y-auto p-4 bg-dark-bg">

      <div
        class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 flex-wrap mb-6 bg-dark-panel p-3 border border-dark-border rounded-md shadow-sm">

        <div class="flex items-center gap-3 px-2">
          <div class="flex items-center gap-2 color-blue">
            <i class="ph-fill ph-calendar-blank"></i>
            <span class="font-14px fw-bold text-upper ls-wide">Time Range</span>
          </div>
          <div class="h-4 w-px bg-dark-border"></div>

          <div class="flex bg-dark-bg p-1 rounded-md border border-dark-border">
            <button data-view="today"
              class="time-btn px-4 py-1.5 font-14px fw-bold rounded-[4px] transition-all duration-200 border border-transparent"
              aria-pressed="true">
              Today
            </button>
            <button data-view="prev"
              class="time-btn px-4 py-1.5 font-14px fw-bold rounded-[4px] transition-all duration-200 border border-transparent color-secondary hover-color-white"
              aria-pressed="false">
              Prev Day
            </button>
            <button data-view="weekly"
              class="time-btn px-4 py-1.5 font-14px fw-bold rounded-[4px] transition-all duration-200 border border-transparent color-secondary hover-color-white"
              aria-pressed="false">
              Weekly
            </button>
            <button data-view="monthly"
              class="time-btn px-4 py-1.5 font-14px fw-bold rounded-[4px] transition-all duration-200 border border-transparent color-secondary hover-color-white"
              aria-pressed="false">
              Monthly
            </button>
          </div>
        </div>

        <!-- Engineer Dropdown and Links -->
        <div class="flex items-center gap-4 px-2">
          <div class="flex items-center gap-2">
            <label class="font-14px fw-bold color-secondary text-upper ls-wide">Manager and Above:</label>
            <select id="engineer-select"
              class="bg-dark-bg border border-dark-border font-14px rounded-md px-3 py-1.5 cursor-pointer hover:border-gnfc-blue transition-colors">
              <option value="">Select Name</option>
              <option value="DVP">DVP</option>
              <option value="HNP">HNP</option>
              <option value="JSP">JSP</option>
              <option value="KSR">KSR</option>
              <option value="LIPIKA">LIPIKA</option>
              <option value="MMD">MMD</option>
              <option value="MMS">MMS</option>
              <option value="MSM">MSM</option>
              <option value="PKT">PKT</option>
              <option value="PMP">PMP</option>
              <option value="RAR">RAR</option>
              <option value="RBL">RBL</option>
              <option value="RDC">RDC</option>
              <option value="SPP">SPP</option>
              <option value="TESTER">TESTER</option>
              <option value="VBS">VBS</option>
              <option value="ATH">ATH</option>
              <option value="BPB">BPB</option>
              <option value="GMP">GMP</option>
              <option value="HDP">HDP</option>
              <option value="MKD">MKD</option>
              <option value="NVR">NVR</option>
              <option value="PHA">PHA</option>
              <option value="RDP">RDP</option>
              <option value="SPR">SPR</option>
              <option value="VMF">VMF</option>
            </select>
          </div>

          <div class="h-4 w-px bg-dark-border"></div>

          <a href="#" onclick="openOldReportsModal(); return false;"
            class="font-14px fw-bold color-blue hover:text-blue-400 transition-colors text-upper ls-wide">
            Old Reports
          </a>
        </div>
      </div>


      <div class="bg-dark-panel border border-dark-border rounded-sm">

        <div class="flex items-center justify-between px-5 py-3 border-b border-dark-border">
          <div class="flex items-center gap-3">
            <div class="w-1 h-5 rounded-full bg-gradient-to-b from-gnfc-blue to-gnfc-teal"></div>
            <h3 class="fw-bold font-18px tracking-tight">Select Plant Unit</h3>
          </div>
        </div>

        <div id="plant-grid"
          class="p-4 grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3">
        </div>

      </div>

      <section class="mt-6 mb-4">

        <div class="flex items-center gap-3 mb-4">
            <div class="w-1 h-6 rounded-full bg-gradient-to-b from-gnfc-blue to-gnfc-purple"></div>
            <h3 class="fw-bold font-18px tracking-tight section-label cursor-default">Officer Logbook Quick Access</h3>
            <div class="h-px flex-1 bg-gradient-to-r from-dark-border/50 to-transparent"></div>
          </div>


        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">

          <button onclick="window.location.href='/src/pages/shift_logbook.html?view=today'"
            class="relative overflow-hidden bg-dark-panel border border-dark-border hover:border-gnfc-blue/50 p-4 rounded-md group text-left transition-all hover:shadow-lg hover:-translate-y-0.5">
            <div class="absolute top-0 right-0 p-2 group-hover:opacity-20 transition-opacity">
              <i class="ph-fill ph-calendar-check text-4xl color-blue"></i>
            </div>
            <p class="font-13px fw-bold color-secondary text-upper ls-wider mb-1">View Report</p>
            <h4 class="font-15px fw-bold color-white group-hover-color-blue transition-colors">Today</h4>
          </button>

          <button onclick="window.location.href='/src/pages/shift_logbook.html?view=prev'"
            class="relative overflow-hidden bg-dark-panel border border-dark-border hover:border-gnfc-blue/50 p-4 rounded-md group text-left transition-all hover:shadow-lg hover:-translate-y-0.5">
            <div class="absolute top-0 right-0 p-2 group-hover:opacity-20 transition-opacity">
              <i class="ph-fill ph-clock-counter-clockwise text-4xl color-yellow"></i>
            </div>
            <p class="font-13px fw-bold color-secondary text-upper ls-wider mb-1">View Report</p>
            <h4 class="font-15px fw-bold color-white group-hover-color-blue transition-colors">Previous Day</h4>
          </button>

          <button onclick="window.location.href='/src/pages/shift_logbook.html?view=weekly'"
            class="relative overflow-hidden bg-dark-panel border border-dark-border hover:border-gnfc-blue/50 p-4 rounded-md group text-left transition-all hover:shadow-lg hover:-translate-y-0.5">
            <div class="absolute top-0 right-0 p-2 group-hover:opacity-20 transition-opacity">
              <i class="ph-fill ph-calendar-plus text-4xl color-red"></i>
            </div>
            <p class="font-13px fw-bold color-secondary text-upper ls-wider mb-1">View Report</p>
            <h4 class="font-15px fw-bold color-white group-hover-color-blue transition-colors">Weekly</h4>
          </button>

          <button onclick="window.location.href='/src/pages/shift_logbook.html?view=monthly'"
            class="relative overflow-hidden bg-dark-panel border border-dark-border hover:border-gnfc-blue/50 p-4 rounded-md group text-left transition-all hover:shadow-lg hover:-translate-y-0.5">
            <div class="absolute top-0 right-0 p-2 group-hover:opacity-20 transition-opacity">
              <i class="ph-fill ph-calendar text-4xl color-green"></i>
            </div>
            <p class="font-13px fw-bold color-secondary text-upper ls-wider mb-1">View Report</p>
            <h4 class="font-15px fw-bold color-white group-hover-color-blue transition-colors">Monthly</h4>
          </button>

          <!-- Old Shift Log Button -->
          <button onclick="alert('Old Shift Log feature coming soon!')"
            class="relative overflow-hidden bg-dark-panel border border-gnfc-orange/50 hover:border-gnfc-orange p-4 rounded-md group text-left transition-all hover:shadow-lg hover:-translate-y-0.5">
            <div class="absolute top-0 right-0 p-2 group-hover:opacity-20 transition-opacity">
              <i class="ph-fill ph-folder-open text-4xl color-orange"></i>
            </div>
            <p class="font-13px fw-bold color-secondary text-upper ls-wider mb-1">Archive</p>
            <h4 class="font-15px fw-bold color-white group-hover-color-orange transition-colors">Old Shift Log</h4>
          </button>

        </div>

      </section>
    </div>

    <!-- Footer -->
    <footer class="bg-dark-panel border-t border-dark-border py-3">
      <div class="text-center">
        <p class="font-14px color-secondary fw-semibold">Instrument Department</p>
        <p class="font-14px color-secondary">Gujarat Narmada Valley Fertilizers Co. Ltd.</p>
      </div>
    </footer>

  </main>

  <!-- Old Reports Modal -->
  <div class="modal micromodal-slide" id="modal-old-reports" aria-hidden="true">
    <div class="gnfc-modal-overlay" tabindex="-1" data-micromodal-close style="display:flex;">
      <div class="gnfc-modal-shell gnfc-modal-shell--medium" role="dialog" aria-modal="true"
        aria-labelledby="modal-old-reports-title">

        <div class="gnfc-modal-header">
          <h3 id="modal-old-reports-title" class="gnfc-modal-title">Old Report Archives</h3>
          <button data-micromodal-close class="gnfc-modal-close" aria-label="Close modal">
            <i class="ph-bold ph-x text-lg"></i>
          </button>
        </div>

        <div class="gnfc-modal-body">
          <div class="flex flex-wrap items-end gap-4 mb-6">
            <div class="flex flex-col gap-1.5 flex-1 min-w-[200px]">
              <label class="gnfc-modal-label">Select Engineer</label>
              <select id="oldReportsEngineer" class="gnfc-modal-input">
                <option value="">-- Select Name --</option>
                <option value="DVP">DVP</option>
                <option value="HNP">HNP</option>
                <option value="JSP">JSP</option>
                <option value="KSR">KSR</option>
                <option value="LIPIKA">LIPIKA</option>
                <option value="MMD">MMD</option>
                <option value="MMS">MMS</option>
                <option value="MSM">MSM</option>
                <option value="PKT">PKT</option>
                <option value="PMP">PMP</option>
                <option value="RAR">RAR</option>
                <option value="RBL">RBL</option>
                <option value="RDC">RDC</option>
                <option value="SPP">SPP</option>
                <option value="TESTER">TESTER</option>
                <option value="VBS">VBS</option>
                <option value="ATH">ATH</option>
                <option value="BPB">BPB</option>
                <option value="GMP">GMP</option>
                <option value="HDP">HDP</option>
                <option value="MKD">MKD</option>
                <option value="NVR">NVR</option>
                <option value="PHA">PHA</option>
                <option value="RDP">RDP</option>
                <option value="SPR">SPR</option>
                <option value="VMF">VMF</option>
              </select>
            </div>

            <div class="flex flex-col gap-1.5">
              <label class="gnfc-modal-label">Date Range</label>
              <div class="flex bg-dark-bg border border-dark-border rounded-sm h-9 items-center p-1">
                <input type="date" id="oldReportsStartDate"
                  class="bg-transparent font-14px color-white outline-none px-2 typo-mono h-full w-36">
                <span class="text-dark-border px-1">to</span>
                <input type="date" id="oldReportsEndDate"
                  class="bg-transparent font-14px color-white outline-none px-2 typo-mono h-full w-36">
              </div>
            </div>
          </div>
        </div>

        <div class="gnfc-modal-footer">
          <button data-micromodal-close class="gnfc-modal-btn gnfc-modal-btn-secondary">Cancel</button>
          <button onclick="submitOldReports()" class="gnfc-modal-btn gnfc-modal-btn-primary">Search Reports</button>
        </div>
      </div>
    </div>
  </div>

  <style>
    /* MicroModal Classes */
    .modal {
      display: none;
    }

    .modal.is-open {
      display: block;
    }

    .modal.is-open .gnfc-modal-overlay {
      display: flex;
    }
  </style>


  <script>
    const timeButtons = document.querySelectorAll(".time-btn");
    let selectedView = "today";

    function setSelectedView(viewName, persist = true) {
      selectedView = ["today", "prev", "weekly", "monthly"].includes(viewName) ? viewName : "today";

      timeButtons.forEach((btn) => {
        const btnView = btn.dataset.view || "";
        const isActive = btnView === selectedView;

        // Reset classes
        btn.className = "time-btn px-4 py-1.5 font-14px fw-bold rounded-[4px] transition-all duration-200 border border-transparent";

        if (isActive) {
          btn.classList.add("bg-gnfc-blue", "color-white", "shadow-sm");
          btn.setAttribute("aria-pressed", "true");
        } else {
          btn.classList.add("color-secondary", "hover-color-white", "hover:bg-white/5");
          btn.setAttribute("aria-pressed", "false");
        }
      });

      if (persist && window.ElogbookStore && typeof window.ElogbookStore.setOfficerSelectedView === "function") {
        window.ElogbookStore.setOfficerSelectedView(selectedView);
      }
      renderPlantCards();
    }

    timeButtons.forEach((button) => {
      button.addEventListener("click", () => {
        setSelectedView(button.dataset.view || "today", true);
      });
    });
  </script>

  <script>
    const units = [
      'AA', 'AAQM', 'AMM', 'ANIPF', 'ANITDI',
      'ASGP', 'BAGG', 'BOILER', 'CMS', 'CPSU',
      'DM', 'EA', 'FA', 'INST WS', 'M1', 'M2', 'UREA'
    ];

    const grid = document.getElementById('plant-grid');

    function renderPlantCards() {
      let gridContent = '';
      units.forEach((code, i) => {
        const href = `/src/pages/shift_logbook.html?plant=${encodeURIComponent(code)}&view=${encodeURIComponent(selectedView)}`;

        gridContent += `
          <a href="${href}"
             class="plant-card rounded-lg px-4 py-3 group flex items-center justify-between gap-2"
             style="animation: fadeInUp 0.4s cubic-bezier(0.4,0,0.2,1) ${i * 0.03}s both;">

            <div class="min-w-0">
              <p class="plant-card-subtitle mb-0.5">Unit Code</p>
              <h3 class="plant-card-title truncate">${code}</h3>
            </div>

            <div class="plant-card-action shrink-0">
              <i class="ph-bold ph-caret-right font-15px"></i>
            </div>
          </a>
        `;
      });
      grid.innerHTML = gridContent;
    }

    const persistedView = (window.ElogbookStore && typeof window.ElogbookStore.getOfficerSelectedView === "function")
      ? window.ElogbookStore.getOfficerSelectedView()
      : "today";
    setSelectedView(persistedView, false);
  </script>


  <script>
    // Initialize MicroModal
    MicroModal.init({
      onShow: modal => console.info(`${modal.id} is shown`),
      onClose: modal => console.info(`${modal.id} is hidden`),
      openTrigger: 'data-micromodal-trigger',
      closeTrigger: 'data-micromodal-close',
      disableScroll: true,
      awaitOpenAnimation: true,
      awaitCloseAnimation: true,
      debugMode: false
    });

    // Old Reports Modal Functions using MicroModal
    function openOldReportsModal() {
      MicroModal.show('modal-old-reports');
    }

    function closeOldReportsModal() {
      MicroModal.close('modal-old-reports');
    }

    function submitOldReports() {
      const engineer = document.getElementById('oldReportsEngineer').value;
      const startDate = document.getElementById('oldReportsStartDate').value;
      const endDate = document.getElementById('oldReportsEndDate').value;

      if (!engineer) {
        alert('Please select an engineer name.');
        return;
      }

      if (!startDate || !endDate) {
        alert('Please select both start and end dates.');
        return;
      }

      // Here you can redirect to old reports page or make an API call
      console.log('Searching reports for:', { engineer, startDate, endDate });
      alert(`Searching reports for ${engineer} from ${startDate} to ${endDate}`);

      // Close the modal
      closeOldReportsModal();
    }

    // ESC key support (MicroModal handles this, but keeping for reference)
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape') {
        closeOldReportsModal();
      }
    });
  </script>

</body>

</html>