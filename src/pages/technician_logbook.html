<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Technician's Logbook | GNFC</title>

  <link rel="stylesheet" href="/src/css/ios-fonts.css">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="/src/js/tailwind_config.js"></script>
  <script>
    window.activePage = 'technician_logbook';
  </script>

  <style>
    /* ===== GLASS CARD - Theme Aware ===== */
    .glass-card {
      background: var(--app-panel);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }

    html[data-theme-mode="dark"] .glass-card {
      background: rgba(24, 27, 31, 0.6);
    }

    html[data-theme-mode="light"] .glass-card {
      background: rgba(255, 255, 255, 0.85);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06), 0 4px 12px rgba(0, 0, 0, 0.04);
    }

    /* ===== GRADIENT BORDER ===== */
    .gradient-border {
      position: relative;
    }

    .gradient-border::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: inherit;
      padding: 1px;
      background: linear-gradient(135deg, rgba(87, 148, 242, 0.3), rgba(20, 184, 166, 0.3), rgba(115, 191, 105, 0.3));
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events: none;
    }

    html[data-theme-mode="light"] .gradient-border::before {
      background: linear-gradient(135deg, rgba(87, 148, 242, 0.2), rgba(20, 184, 166, 0.2), rgba(115, 191, 105, 0.2));
    }

    /* ===== PLANT CARD ===== */
    .plant-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .plant-card:hover {
      transform: translateY(-4px);
    }

    .plant-card::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: inherit;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .plant-card:hover::after {
      opacity: 1;
    }

    .plant-card.status-operational::after {
      background: linear-gradient(135deg, rgba(115, 191, 105, 0.05), transparent 60%);
    }

    .plant-card.status-maintenance::after {
      background: linear-gradient(135deg, rgba(255, 153, 0, 0.05), transparent 60%);
    }

    /* Light mode: stronger glow for visibility */
    html[data-theme-mode="light"] .plant-card {
      background: #ffffff !important;
      border-color: var(--app-border) !important;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
    }

    html[data-theme-mode="light"] .plant-card:hover {
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08) !important;
    }

    html[data-theme-mode="light"] .plant-card.status-operational::after {
      background: linear-gradient(135deg, rgba(115, 191, 105, 0.08), transparent 60%);
    }

    html[data-theme-mode="light"] .plant-card.status-maintenance::after {
      background: linear-gradient(135deg, rgba(255, 153, 0, 0.08), transparent 60%);
    }

    /* ===== STATUS DOT PULSE ===== */
    .status-dot {
      animation: pulse-dot 2s ease-in-out infinite;
    }

    @keyframes pulse-dot {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }
    }

    /* ===== QUICK ACCESS CARD ===== */
    .qa-card {
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .qa-card:hover {
      transform: translateY(-3px);
    }

    .qa-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      border-radius: 999px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .qa-card:hover::before {
      opacity: 1;
    }

    html[data-theme-mode="light"] .qa-card {
      background: #ffffff !important;
      border-color: var(--app-border) !important;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
    }

    html[data-theme-mode="light"] .qa-card:hover {
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08) !important;
    }

    /* ===== SCROLLBAR ===== */
    .custom-scroll::-webkit-scrollbar {
      width: 4px;
    }

    .custom-scroll::-webkit-scrollbar-track {
      background: transparent;
    }

    .custom-scroll::-webkit-scrollbar-thumb {
      background: var(--app-border);
      border-radius: 4px;
    }

    .custom-scroll::-webkit-scrollbar-thumb:hover {
      background: var(--app-muted);
    }

    /* ===== SECTION LABEL UNDERLINE ===== */
    .section-label {
      position: relative;
    }

    .section-label::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #5794F2, #14b8a6);
      border-radius: 2px;
      transition: width 0.4s ease;
    }

    .section-label:hover::after {
      width: 100%;
    }

    /* ===== LIGHT THEME: Status chips & toolbar ===== */
    html[data-theme-mode="light"] .glass-card .time-btn {
      color: var(--app-muted);
    }

    html[data-theme-mode="light"] .glass-card .time-btn[aria-pressed="true"] {
      color: #ffffff !important;
    }

    /* ===== LIGHT THEME: Footer ===== */
    html[data-theme-mode="light"] footer {
      background: rgba(255, 255, 255, 0.7) !important;
      border-color: var(--app-border) !important;
    }

    /* ===== FADE IN ANIMATION ===== */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }
  </style>
</head>

<body class="bg-dark-bg text-dark-text font-sans h-screen flex overflow-hidden">

  <script src="/src/js/theme_manager.js"></script>
  <script src="/src/js/sidebar.js"></script>
  <script src="/src/js/elogbook_store.js"></script>
  <div id="sidebar-container"></div>
  <script>renderSidebar('technician_logbook');</script>

  <main class="flex-1 flex flex-col h-screen overflow-hidden">

    <div id="header-container"></div>
    <script src="/src/js/header.js"></script>
    <script>
      renderHeader({
        title: "Technician's Logbook",
        breadcrumbs: [
          { label: "Technician's Logbook" }
        ],
        backLink: "/index.html"
      });
    </script>

    <div class="flex-1 overflow-y-auto custom-scroll">

      <!-- Top Stats Bar + Time Range -->
      <div class="px-4 pt-4 pb-2">
        <div class="glass-card gradient-border rounded-xl p-4 animate-fade-in">
          <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-4 flex-wrap">

            <!-- Time Range Selector -->
            <div class="flex items-center gap-2">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg bg-gnfc-blue/15 flex items-center justify-center">
                  <i class="ph-fill ph-calendar-blank text-gnfc-blue text-sm"></i>
                </div>
                <span class="text-xs font-bold uppercase tracking-widest text-dark-muted">Time Range</span>
              </div>
              <div class="h-5 w-px bg-dark-border/50"></div>
              <div class="flex bg-dark-bg/80 p-1 rounded-lg border border-dark-border/50 gap-x-1">
                <button data-view="today"
                  class="time-btn px-4 py-2 text-[11px] font-bold rounded-md transition-all duration-300 border border-transparent"
                  aria-pressed="true">
                  Today
                </button>
                <button data-view="prev"
                  class="time-btn px-4 py-2 text-[11px] font-bold rounded-md transition-all duration-300 border border-transparent text-dark-muted hover:text-white"
                  aria-pressed="false">
                  Prev Day
                </button>
                <button data-view="weekly"
                  class="time-btn px-4 py-2 text-[11px] font-bold rounded-md transition-all duration-300 border border-transparent text-dark-muted hover:text-white"
                  aria-pressed="false">
                  Weekly
                </button>
              </div>
            </div>

            <!-- Summary Stats -->
            <div class="flex items-center gap-3">
              <div id="stat-operational"
                class="flex items-center gap-2 bg-gnfc-green/10 border border-gnfc-green/20 rounded-lg px-3 py-1.5">
                <div class="w-2 h-2 rounded-full bg-gnfc-green status-dot"></div>
                <span class="text-[10px] font-bold text-gnfc-green uppercase tracking-wider">Operational: <span
                    id="op-count">0</span></span>
              </div>
              <div id="stat-maintenance"
                class="flex items-center gap-2 bg-gnfc-orange/10 border border-gnfc-orange/20 rounded-lg px-3 py-1.5">
                <div class="w-2 h-2 rounded-full bg-gnfc-orange status-dot" style="animation-delay: 0.5s;"></div>
                <span class="text-[10px] font-bold text-gnfc-orange uppercase tracking-wider">Maintenance: <span
                    id="mt-count">0</span></span>
              </div>
              <div class="flex items-center gap-2 bg-gnfc-blue/10 border border-gnfc-blue/20 rounded-lg px-3 py-1.5">
                <i class="ph-bold ph-factory text-gnfc-blue text-xs"></i>
                <span class="text-[10px] font-bold text-gnfc-blue uppercase tracking-wider">Total: <span
                    id="total-count">17</span></span>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- Plant Units Grid -->
      <div class="px-4 py-2">
        <div class="glass-card rounded-xl border border-dark-border/40 overflow-hidden animate-fade-in"
          style="animation-delay: 0.1s;">

          <div class="flex items-center justify-between px-5 py-3 border-b border-dark-border/40">
            <div class="flex items-center gap-3">
              <div class="w-1 h-5 rounded-full bg-gradient-to-b from-gnfc-blue to-gnfc-teal"></div>
              <h3 class="font-bold text-sm tracking-tight section-label cursor-default">Select Plant Unit</h3>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-[10px] text-dark-muted font-mono" id="grid-count">17 Units</span>
            </div>
          </div>

          <div id="plant-grid"
            class="p-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3">
          </div>

        </div>
      </div>

      <!-- Officer Logbook Quick Access -->
      <div class="px-4 pt-2 pb-6">
        <div class="animate-fade-in" style="animation-delay: 0.2s;">

          <div class="flex items-center gap-3 mb-4">
            <div class="w-1 h-6 rounded-full bg-gradient-to-b from-gnfc-blue to-gnfc-purple"></div>
            <h3 class="font-bold text-sm tracking-tight section-label cursor-default">Officer Logbook Quick Access</h3>
            <div class="h-px flex-1 bg-gradient-to-r from-dark-border/50 to-transparent"></div>
          </div>

          <div class="grid grid-cols-2 md:grid-cols-4 gap-3">

            <button onclick="window.location.href='/src/pages/shift_logbook.html?view=today'"
              class="qa-card glass-card border border-dark-border/40 hover:border-gnfc-blue/40 p-5 rounded-xl group text-left hover:shadow-lg hover:shadow-gnfc-blue/5">
              <div class="qa-card-top" style="--qa-color: #5794F2;">
              </div>
              <div class="flex items-start justify-between mb-3">
                <div
                  class="w-10 h-10 rounded-xl bg-gnfc-blue/10 border border-gnfc-blue/20 flex items-center justify-center group-hover:bg-gnfc-blue/20 group-hover:scale-110 transition-all duration-300">
                  <i class="ph-fill ph-calendar-check text-gnfc-blue text-lg"></i>
                </div>
                <i
                  class="ph-bold ph-arrow-up-right text-dark-muted/30 group-hover:text-gnfc-blue/60 transition-colors text-sm"></i>
              </div>
              <p class="text-[10px] font-bold text-dark-muted uppercase tracking-widest mb-0.5">View Report</p>
              <h4 class="text-sm font-bold group-hover:text-gnfc-blue transition-colors">Today</h4>
              <style>
                .qa-card:nth-child(1)::before {
                  background: linear-gradient(90deg, #5794F2, #14b8a6);
                }
              </style>
            </button>

            <button onclick="window.location.href='/src/pages/shift_logbook.html?view=prev'"
              class="qa-card glass-card border border-dark-border/40 hover:border-gnfc-teal/40 p-5 rounded-xl group text-left hover:shadow-lg hover:shadow-gnfc-teal/5">
              <div class="flex items-start justify-between mb-3">
                <div
                  class="w-10 h-10 rounded-xl bg-gnfc-teal/10 border border-gnfc-teal/20 flex items-center justify-center group-hover:bg-gnfc-teal/20 group-hover:scale-110 transition-all duration-300">
                  <i class="ph-fill ph-clock-counter-clockwise text-gnfc-teal text-lg"></i>
                </div>
                <i
                  class="ph-bold ph-arrow-up-right text-dark-muted/30 group-hover:text-gnfc-teal/60 transition-colors text-sm"></i>
              </div>
              <p class="text-[10px] font-bold text-dark-muted uppercase tracking-widest mb-0.5">View Report</p>
              <h4 class="text-sm font-bold group-hover:text-gnfc-teal transition-colors">Previous Day</h4>
              <style>
                .qa-card:nth-child(2)::before {
                  background: linear-gradient(90deg, #14b8a6, #10b981);
                }
              </style>
            </button>

            <button onclick="window.location.href='/src/pages/shift_logbook.html?view=weekly'"
              class="qa-card glass-card border border-dark-border/40 hover:border-gnfc-purple/40 p-5 rounded-xl group text-left hover:shadow-lg hover:shadow-gnfc-purple/5">
              <div class="flex items-start justify-between mb-3">
                <div
                  class="w-10 h-10 rounded-xl bg-gnfc-purple/10 border border-gnfc-purple/20 flex items-center justify-center group-hover:bg-gnfc-purple/20 group-hover:scale-110 transition-all duration-300">
                  <i class="ph-fill ph-calendar-plus text-gnfc-purple text-lg"></i>
                </div>
                <i
                  class="ph-bold ph-arrow-up-right text-dark-muted/30 group-hover:text-gnfc-purple/60 transition-colors text-sm"></i>
              </div>
              <p class="text-[10px] font-bold text-dark-muted uppercase tracking-widest mb-0.5">View Report</p>
              <h4 class="text-sm font-bold group-hover:text-gnfc-purple transition-colors">Weekly</h4>
              <style>
                .qa-card:nth-child(3)::before {
                  background: linear-gradient(90deg, #B794F4, #5794F2);
                }
              </style>
            </button>

            <button onclick="window.location.href='/src/pages/shift_logbook.html?view=monthly'"
              class="qa-card glass-card border border-dark-border/40 hover:border-gnfc-emerald/40 p-5 rounded-xl group text-left hover:shadow-lg hover:shadow-gnfc-emerald/5">
              <div class="flex items-start justify-between mb-3">
                <div
                  class="w-10 h-10 rounded-xl bg-gnfc-emerald/10 border border-gnfc-emerald/20 flex items-center justify-center group-hover:bg-gnfc-emerald/20 group-hover:scale-110 transition-all duration-300">
                  <i class="ph-fill ph-calendar text-gnfc-emerald text-lg"></i>
                </div>
                <i
                  class="ph-bold ph-arrow-up-right text-dark-muted/30 group-hover:text-gnfc-emerald/60 transition-colors text-sm"></i>
              </div>
              <p class="text-[10px] font-bold text-dark-muted uppercase tracking-widest mb-0.5">View Report</p>
              <h4 class="text-sm font-bold group-hover:text-gnfc-emerald transition-colors">Monthly</h4>
              <style>
                .qa-card:nth-child(4)::before {
                  background: linear-gradient(90deg, #10b981, #73BF69);
                }
              </style>
            </button>

          </div>
        </div>
      </div>

    </div>

    <!-- Footer -->
    <footer class="border-t border-dark-border/40 py-2.5 px-4 bg-dark-panel/50 backdrop-blur-sm">
      <div class="flex items-center justify-between">
        <p class="text-[10px] text-dark-muted/60 font-medium">Instrument Department &bull; GNFC Ltd.</p>
        <p class="text-[10px] text-dark-muted/40 font-mono">&copy; 2026</p>
      </div>
    </footer>

  </main>


  <!-- Time Range Logic -->
  <script>
    const timeButtons = document.querySelectorAll(".time-btn");
    let selectedView = "today";

    function setSelectedView(viewName, persist = true) {
      selectedView = ["today", "prev", "weekly", "monthly"].includes(viewName) ? viewName : "today";

      timeButtons.forEach((btn) => {
        const btnView = btn.dataset.view || "";
        const isActive = btnView === selectedView;

        btn.className = "time-btn px-4 py-2 text-[11px] font-bold rounded-md transition-all duration-300 border border-transparent";

        if (isActive) {
          btn.classList.add("bg-gnfc-blue", "text-white", "shadow-md", "shadow-gnfc-blue/20");
          btn.setAttribute("aria-pressed", "true");
        } else {
          btn.classList.add("text-dark-muted", "hover:text-white", "hover:bg-white/5");
          btn.setAttribute("aria-pressed", "false");
        }
      });

      if (persist && window.ElogbookStore && typeof window.ElogbookStore.setTechnicianSelectedView === "function") {
        window.ElogbookStore.setTechnicianSelectedView(selectedView);
      }
      renderPlantCards();
    }

    timeButtons.forEach((button) => {
      button.addEventListener("click", () => {
        setSelectedView(button.dataset.view || "today", true);
      });
    });
  </script>

  <!-- Plant Grid Logic -->
  <script>
    const units = [
      'AA', 'AAQM', 'AMM', 'ANIPF', 'ANITDI',
      'ASGP', 'BAGG', 'BOILER', 'CMS', 'CPSU',
      'DM', 'EA', 'FA', 'INST WS', 'M1', 'M2', 'UREA'
    ];

    const grid = document.getElementById('plant-grid');

    function renderPlantCards() {
      let gridContent = '';
      let opCount = 0;
      let mtCount = 0;

      units.forEach((code, i) => {
        const status = i % 4 === 0 ? 'Maintenance' : 'Operational';
        if (status === 'Operational') opCount++; else mtCount++;

        const isOp = status === 'Operational';
        const color = isOp ? '#73BF69' : '#FF9900';
        const statusClass = isOp ? 'status-operational' : 'status-maintenance';
        const unitNumber = (i + 1).toString().padStart(2, '0');
        const href = `/src/pages/plant_detail.html?plant=${encodeURIComponent(code)}&view=${encodeURIComponent(selectedView)}`;

        const borderColor = isOp ? 'border-gnfc-green/20 hover:border-gnfc-green/50' : 'border-gnfc-orange/20 hover:border-gnfc-orange/50';
        const glowColor = isOp ? 'hover:shadow-gnfc-green/10' : 'hover:shadow-gnfc-orange/10';
        const iconBg = isOp ? 'bg-gnfc-green/10' : 'bg-gnfc-orange/10';
        const textHover = isOp ? 'group-hover:text-gnfc-green' : 'group-hover:text-gnfc-orange';

        gridContent += `
          <a href="${href}"
             class="plant-card ${statusClass} relative glass-card border ${borderColor} rounded-xl p-4 flex flex-col gap-3
                    group shadow-sm hover:shadow-lg ${glowColor} overflow-hidden"
             style="animation: fadeInUp 0.4s cubic-bezier(0.4,0,0.2,1) ${i * 0.03}s both;">
            
            <!-- Top: Number + Status Dot -->
            <div class="flex justify-between items-center">
              <span class="text-[10px] font-mono text-dark-muted/60 font-bold tracking-wider">#${unitNumber}</span>
              <div class="flex items-center gap-1.5">
                <span class="text-[8px] uppercase font-bold tracking-wider" style="color: ${color}">${status}</span>
                <div class="w-2 h-2 rounded-full status-dot" style="background-color: ${color}; box-shadow: 0 0 8px ${color}40;"></div>
              </div>
            </div>

            <!-- Center: Unit Code -->
            <div class="flex items-center gap-2.5">
              <div class="w-8 h-8 rounded-lg ${iconBg} flex items-center justify-center shrink-0">
                <i class="ph-bold ph-factory text-sm" style="color: ${color}"></i>
              </div>
              <h3 class="text-base font-bold tracking-tight ${textHover} transition-colors">${code}</h3>
            </div>

            <!-- Bottom bar -->
            <div class="h-0.5 w-full rounded-full" style="background: linear-gradient(90deg, ${color}40, transparent);"></div>
          </a>
        `;
      });

      grid.innerHTML = gridContent;

      // Update stats
      document.getElementById('op-count').textContent = opCount;
      document.getElementById('mt-count').textContent = mtCount;
      document.getElementById('total-count').textContent = units.length;
      document.getElementById('grid-count').textContent = units.length + ' Units';
    }

    const persistedView = (window.ElogbookStore && typeof window.ElogbookStore.getTechnicianSelectedView === "function")
      ? window.ElogbookStore.getTechnicianSelectedView()
      : "today";
    setSelectedView(persistedView, false);
  </script>

</body>

</html>