<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GNFC | Tag Filter Analysis</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="/src/js/tailwind_config.js"></script>
  <link rel="stylesheet" href="/src/css/modal-ui.css">
  <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
  <style>
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #111217;
    }

    ::-webkit-scrollbar-thumb {
      background: #2C3235;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #444;
    }

    /* MicroModal base */
    .modal {
      display: none;
    }

    .modal.is-open {
      display: block;
    }

    .modal.is-open .gnfc-modal-overlay {
      display: flex;
    }
  </style>
</head>

<body class="bg-dark-bg text-dark-text h-screen flex overflow-hidden">


  <script src="/src/js/theme_manager.js"></script>
  <script src="/src/js/sidebar.js"></script>
  <script src="/src/js/header.js"></script>
  <div id="sidebar-container"></div>
  <script>try { renderSidebar('technician_logbook'); } catch (e) { }</script>

  <main class="flex-1 flex flex-col h-screen overflow-hidden">

    <div id="header-container"></div>
    <script>
      renderHeader({
        title: "Acetic Acid Logbook",
        breadcrumbs: [
          { label: "Technician Log", href: "technician_logbook.html" },
          { label: "Plant Detail", href: "plant_detail.html" },
          { label: "Tagwise Filter" }
        ],
        backLink: "plant_detail.html"
      });
    </script>
    <div class="flex-1 overflow-y-auto py-4 bg-dark-bg relative p-4">
      <!-- Top Navigation Bar -->
      <div id="plant-nav-container"></div>
      <script src="/src/js/plant_nav.js"></script>
      <script>
        renderPlantNav('tagwise_filter');
      </script>

      <!-- Filter Card -->
      <div class="bg-dark-panel border border-dark-border rounded my-4 shadow-sm">
        <div
          class="px-4 py-3 border-b border-dark-border bg-dark-header rounded-t-md flex justify-between items-center">
          <div class="flex items-center gap-2 text-sm font-bold uppercase tracking-wide">
            <i class="ph-bold ph-funnel text-gnfc-blue"></i> Filter Query
          </div>
        </div>

        <div class="p-4 flex flex-col md:flex-row items-end gap-4 flex">
          <div class="flex-1">
            <label class="block text-[10px] uppercase font-bold text-dark-muted mb-1.5">Enter Tag Number</label>
            <div class="relative group">
              <input type="text" id="tagInput" value="A7801A"
                class="w-full bg-dark-bg border border-dark-border  text-sm rounded-md px-4 py-2 h-9 pl-10 focus:border-gnfc-blue focus:ring-1 focus:ring-gnfc-blue outline-none transition-all font-mono tracking-wide placeholder-dark-muted"
                placeholder="e.g. PT-101">
              <i
                class="ph-bold ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-dark-muted group-focus-within:text-gnfc-blue transition-colors"></i>
            </div>

          </div>
          <div class="flex gap-2">
            <button onclick="showReport()"
              class="bg-gnfc-blue hover:bg-blue-600 font-bold py-2.5 px-6 rounded shadow-lg shadow-blue-500/20 transition-all flex items-center gap-2 whitespace-nowrap h-9 text-white text-sm">
              <i class="ph-bold ph-lightning"></i> Apply Filter
            </button>

            <button onclick="resetView()"
              class="bg-dark-bg border border-dark-border hover:border-gnfc-red hover:text-gnfc-red text-dark-muted font-bold py-2.5 px-4 rounded transition-all flex items-center gap-2 whitespace-nowrap h-9 text-sm">
              <i class="ph-bold ph-arrow-counter-clockwise"></i> Reset
            </button>
          </div>
        </div>

      </div>

      <!-- Results Section -->
      <div id="report-container" class="hidden flex-col space-y-4">

        <div class="bg-dark-panel border border-dark-border rounded-sm p-3 flex items-center justify-between">
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 px-3 py-1 bg-dark-bg border border-dark-border rounded-sm">
              <span class="text-[10px] text-dark-muted uppercase font-bold">Tag:</span>
              <span class="text-sm font-mono text-gnfc-orange font-bold" id="displayTag"></span>
            </div>
            <span class="text-xs text-dark-muted">Found <span class=" font-bold">10</span> historical
              records</span>
          </div>
        </div>

        <div class="bg-dark-panel border border-dark-border rounded-md shadow-sm flex-1 flex flex-col overflow-hidden">
          <div class="overflow-x-auto">
            <table class="w-full text-left border-collapse">
              <thead>
                <tr
                  class="bg-dark-header text-[10px] font-bold text-dark-muted uppercase tracking-widest text-center border-b border-dark-border">
                  <th rowspan="2" class="border-r border-dark-border px-2 py-3 w-10">Sr</th>
                  <th rowspan="2" class="border-r border-dark-border px-2 py-3 w-16">Area</th>
                  <th class="border-r border-dark-border px-2 py-1 w-32 border-b border-dark-border ">LoopNo
                  </th>
                  <th class="border-r border-dark-border px-2 py-1 min-w-[150px] border-b border-dark-border ">
                    Job</th>
                  <th rowspan="2" class="border-r border-dark-border px-2 py-3 w-16">Tech</th>
                  <th rowspan="2" class="border-r border-dark-border px-4 py-3 min-w-[300px] text-left">Description</th>
                  <th rowspan="2" class="border-r border-dark-border px-2 py-3 w-16">Tech</th>
                  <th rowspan="2" class="border-r border-dark-border px-2 py-3 w-20">Status</th>
                  <th rowspan="2" class="px-4 py-3 min-w-[150px]">Remarks</th>
                </tr>
                <tr
                  class="bg-dark-header text-[9px] font-bold text-gnfc-blue uppercase text-center border-b border-dark-border">
                  <th class="border-r border-dark-border px-2 py-1">TagNo</th>
                  <th class="border-r border-dark-border px-2 py-1">TypeOfJob</th>
                </tr>
              </thead>
              <tbody id="reportTableBody" class="text-xs font-mono">
                <!-- Rows injected via JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </main>

  <script>
    // Data from your image (image_4bfdda.png)
    const historyData = [
      {
        date: '30/01/2026',
        items: [
          { sr: 1, area: '7800', loop: 'N.A.', tag: 'A7801A', job: 'To be checked as reported Cable found full in hanging condition near 7800 sec.', type: 'HOUSE KEEPING', tech1: 'ALS', desc: 'Proper cable dressing done.', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '29/01/2026',
        items: [
          { sr: 2, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: 'To be checked as reported Cable found full in hanging condition near 7800 sec.', type: 'HOUSE KEEPING', tech1: 'ALS', desc: 'Job is U/P.', tech2: 'ALS', status: 'U/P' }
        ]
      },
      {
        date: '24/01/2026',
        items: [
          { sr: 3, area: '7800', loop: 'N.A.', tag: 'A7801A', job: 'To be checked as reported Cable found full in hanging condition near 7800 sec.', type: 'HOUSE KEEPING', tech1: 'ALS', desc: 'Cable was detached from cable tray. So it is req to dressing it proper.', tech2: 'ALS', status: 'U/P' }
        ]
      },
      {
        date: '02/03/2022',
        items: [
          { sr: 4, area: '7800', loop: 'N.A.', tag: 'A7801A', job: '7800 all sequence valve oil level to be topped up.', type: 'PM', tech1: 'ALS', desc: 'KV7802, 7804, 7805, 7807 oil filling done.', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '10/07/2017',
        items: [
          { sr: 5, area: '7800', loop: 'N.A.', tag: 'A7801A', job: '', type: 'PROCESS REQMT', tech1: '', desc: 'TE449 -As per process requirement Element disconnected from its nipple union connections.', tech2: 'GAZ', status: 'OVER' }
        ]
      },
      {
        date: '12/11/2013',
        items: [
          { sr: 6, area: '7800', loop: 'N.A.', tag: 'A7801A', job: '', type: 'N.A.', tech1: '', desc: '-Visited to store and Metso metso make valve PV2303, PV2304, PV2325 valve spare part identified and its list prepared.', tech2: 'GAZ', status: 'OVER' }
        ]
      },
      {
        date: '21/05/2011',
        items: [
          { sr: 7, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: '', type: 'PROCESS REQMT', tech1: '', desc: 'As per process req. Pressure measurement of N2 line after NRV done(5.8bar).', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '20/05/2011',
        items: [
          { sr: 8, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: '', type: 'PROCESS REQMT', tech1: '', desc: 'As per process req. pressure measurement done(70bar) in Nitrogen line in A7801.', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '01/10/2009',
        items: [
          { sr: 9, area: '7800', loop: 'N.A.', tag: 'A7801A', job: 'SEC 7800 C/V pm to be done.', type: 'PM', tech1: 'JMD', desc: 'Permit not issued due to startup activity.', tech2: 'JMD', status: 'OVER' }
        ]
      },
      {
        date: '22/06/2007',
        items: [
          { sr: 10, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: 'analyzer round to be taken', type: 'PM', tech1: 'JMD', desc: 'Routine analyzer round taken, except sec500/600. Also CO level was found high in sec700 ana. room.', tech2: 'JMD', status: 'OVER' }
        ]
      }
    ];

    function showReport() {
      const tagInput = document.getElementById('tagInput').value;
      if (!tagInput) {
        alert("Please enter a tag number");
        return;
      }

      document.getElementById('displayTag').innerText = tagInput;
      document.getElementById('report-container').classList.remove('hidden');
      document.getElementById('report-container').classList.add('flex');

      renderTable();
    }

    function resetView() {
      document.getElementById('tagInput').value = '';
      document.getElementById('report-container').classList.add('hidden');
      document.getElementById('report-container').classList.remove('flex');
    }

    function renderTable() {
      const tbody = document.getElementById('reportTableBody');
      tbody.innerHTML = '';

      historyData.forEach(group => {
        // 1. Date Header Row
        const headerRow = `
                    <tr class="border-y border-dark-border">
                        <td colspan="9" class="px-4 py-1.5 text-[11px] font-bold text-gnfc-orange uppercase tracking-wide flex items-center gap-2">
                            <i class="ph-fill ph-calendar-blank"></i> ${group.date}
                        </td>
                    </tr>
                `;
        tbody.innerHTML += headerRow;

        // 2. Data Rows
        group.items.forEach(item => {
          const statusClass = item.status === 'OVER'
            ? 'text-gnfc-green bg-gnfc-green/10 border-gnfc-green/20'
            : 'text-gnfc-orange bg-gnfc-orange/10 border-gnfc-orange/20';

          const row = `
                        <tr class="hover:bg-white/5 transition-colors border-b border-dark-border group">
                            <td class="border-r border-dark-border px-2 py-3 text-center text-dark-muted font-mono">${item.sr}</td>
                            <td class="border-r border-dark-border px-2 py-3 font-bold  text-center">${item.area}</td>

                            <td class="border-r border-dark-border px-2 py-3">
                                <div class="text-xs text-dark-muted">${item.loop}</div>
                                <div class="text-xs font-bold text-gnfc-blue mt-1">${item.tag}</div>
                            </td>

                            <td class="border-r border-dark-border px-2 py-3">
                                <div class="text-xs leading-tight mb-1" title="${item.job}">${item.job || '-'}</div>
                                <span class="text-[9px] font-bold text-gnfc-orange uppercase bg-dark-bg px-1 rounded border border-dark-border">${item.type}</span>
                            </td>

                            <td class="border-r border-dark-border px-2 py-3 text-center font-bold  text-xs">${item.tech1}</td>

                            <td class="border-r border-dark-border px-4 py-3 text-xs text-dark-text leading-relaxed">
                                ${item.desc}
                            </td>

                            <td class="border-r border-dark-border px-2 py-3 text-center font-bold  text-xs">${item.tech2}</td>

                            <td class="border-r border-dark-border px-2 py-3 text-center">
                                <span class="inline-block text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded-sm border ${statusClass}">
                                    ${item.status}
                                </span>
                            </td>

                            <td class="px-2 py-3"></td>
                        </tr>
                    `;
          tbody.innerHTML += row;
        });
      });
    }
  </script>
  <script src="/src/js/emg_call_modal.js"></script>
  <script src="/src/js/pagination.js"></script>
</body>

</html>