<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GNFC | Tag Filter Analysis</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="/src/js/tailwind_config.js"></script>
  <link rel="stylesheet" href="/src/css/ios-fonts.css">
  <link rel="stylesheet" href="/src/css/typography.css">
  <link rel="stylesheet" href="/src/css/modal-ui.css">
  <link rel="stylesheet" href="/src/css/table-style.css">
  <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
  <style>
    /* MicroModal base */
    .modal {
      display: none;
    }

    .modal.is-open {
      display: block;
    }

    .modal.is-open .gnfc-modal-overlay {
      display: flex;
    }
  </style>
</head>

<body class="bg-dark-bg color-primary h-screen flex overflow-hidden">


  <script src="/src/js/theme_manager.js"></script>
  <script src="/src/js/sidebar.js"></script>
  <script src="/src/js/header.js"></script>
  <div id="sidebar-container"></div>
  <script>try { renderSidebar('technician_logbook'); } catch (e) { }</script>

  <main class="flex-1 flex flex-col h-screen overflow-hidden">

    <div id="header-container"></div>
    <script>
      renderHeader({
        title: "Acetic Acid Logbook",
        breadcrumbs: [
          { label: "Technician Log", href: "technician_logbook.html" },
          { label: "Plant Detail", href: "plant_detail.html" },
          { label: "Tagwise Filter" }
        ],
        backLink: "plant_detail.html"
      });
    </script>
    <div class="flex-1 overflow-y-auto py-4 bg-dark-bg relative p-4">
      <!-- Top Navigation Bar -->
      <div id="plant-nav-container"></div>
      <script src="/src/js/plant_nav.js"></script>
      <script>
        renderPlantNav('tagwise_filter');
      </script>

      <!-- Filter Card -->
      <div class="bg-dark-panel border border-dark-border rounded-sm my-4 shadow-sm">
        <div
          class="px-4 py-3 border-b border-dark-border bg-dark-header rounded-t-sm flex justify-between items-center">
          <div class="flex items-center gap-2 font-14px fw-bold uppercase tracking-wide color-primary">
            <i class="ph-bold ph-funnel color-blue"></i> Filter Query
          </div>
        </div>

        <div class="p-4 flex flex-col md:flex-row items-end gap-4 flex">
          <div class="flex-1">
            <label class="block font-10px fw-bold color-label text-upper ls-wide mb-1.5">Enter Tag Number</label>
            <div class="relative group">
              <input type="text" id="tagInput" value="A7801A"
                class="w-full bg-dark-bg border border-dark-border  font-14px rounded-sm px-4 py-2 h-9 pl-10 focus:border-gnfc-blue focus:ring-1 focus:ring-gnfc-blue outline-none transition-all typo-mono tracking-wide placeholder-dark-muted color-primary"
                placeholder="e.g. PT-101">
              <i
                class="ph-bold ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 color-label group-focus-within:text-gnfc-blue transition-colors font-16px"></i>
            </div>

          </div>
          <div class="flex gap-2">
            <button onclick="showReport()"
              class="bg-gnfc-blue hover:bg-blue-600 fw-bold py-2.5 px-6 rounded-sm shadow-lg shadow-blue-500/20 transition-all flex items-center gap-2 whitespace-nowrap h-9 text-white font-14px">
              <i class="ph-bold ph-lightning"></i> Apply Filter
            </button>

            <button onclick="resetView()"
              class="bg-dark-bg border border-dark-border hover:border-gnfc-red hover:text-gnfc-red color-label fw-bold py-2.5 px-4 rounded-sm transition-all flex items-center gap-2 whitespace-nowrap h-9 font-14px">
              <i class="ph-bold ph-arrow-counter-clockwise"></i> Reset
            </button>
          </div>
        </div>

      </div>

      <!-- Results Section -->
      <div id="report-container" class="hidden flex-col space-y-4">

        <div class="bg-dark-panel border border-dark-border rounded-sm p-3 flex items-center justify-between">
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 px-3 py-1 bg-dark-bg border border-dark-border rounded-sm">
              <span class="font-10px color-label fw-bold text-upper ls-wide">Tag:</span>
              <span class="font-14px typo-mono color-orange fw-bold" id="displayTag"></span>
            </div>
            <span class="font-12px color-label">Found <span class="fw-bold color-primary">10</span> historical
              records</span>
          </div>
        </div>

        <div class="bg-dark-panel border border-dark-border rounded-md shadow-sm flex-1 flex flex-col overflow-hidden">
          <div class="gnfc-table-container overflow-x-auto">
            <table class="gnfc-table">
              <thead class="gnfc-thead">
                <tr>
                  <th rowspan="2" class="gnfc-th w-10 border-r border-gray-400">Sr</th>
                  <th rowspan="2" class="gnfc-th w-16 border-r border-gray-400">Area</th>
                  <th class="gnfc-th w-32 border-b border-gray-400 border-r border-gray-400">LoopNo</th>
                  <th class="gnfc-th min-w-[150px] border-b border-gray-400 border-r border-gray-400">Job</th>
                  <th rowspan="2" class="gnfc-th w-16 border-r border-gray-400">Tech</th>
                  <th rowspan="2" class="gnfc-th min-w-[300px] text-left border-r border-gray-400">Description</th>
                  <th rowspan="2" class="gnfc-th w-20 border-r border-gray-400">Status</th>
                  <th rowspan="2" class="gnfc-th min-w-[150px]">Remarks</th>
                </tr>
                <tr>
                  <th class="gnfc-th border-r border-gray-400 px-2 py-1">TagNo</th>
                  <th class="gnfc-th border-r border-gray-400 px-2 py-1">TypeOfJob</th>
                </tr>
              </thead>
              <tbody id="reportTableBody" class="gnfc-tbody">
                <!-- Rows injected via JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </main>

  <script>
    // Data from your image (image_4bfdda.png)
    const historyData = [
      {
        date: '30/01/2026',
        items: [
          { sr: 1, area: '7800', loop: 'N.A.', tag: 'A7801A', job: 'To be checked as reported Cable found full in hanging condition near 7800 sec.', type: 'HOUSE KEEPING', tech1: 'ALS', desc: 'Proper cable dressing done.', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '29/01/2026',
        items: [
          { sr: 2, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: 'To be checked as reported Cable found full in hanging condition near 7800 sec.', type: 'HOUSE KEEPING', tech1: 'ALS', desc: 'Job is U/P.', tech2: 'ALS', status: 'U/P' }
        ]
      },
      {
        date: '24/01/2026',
        items: [
          { sr: 3, area: '7800', loop: 'N.A.', tag: 'A7801A', job: 'To be checked as reported Cable found full in hanging condition near 7800 sec.', type: 'HOUSE KEEPING', tech1: 'ALS', desc: 'Cable was detached from cable tray. So it is req to dressing it proper.', tech2: 'ALS', status: 'U/P' }
        ]
      },
      {
        date: '02/03/2022',
        items: [
          { sr: 4, area: '7800', loop: 'N.A.', tag: 'A7801A', job: '7800 all sequence valve oil level to be topped up.', type: 'PM', tech1: 'ALS', desc: 'KV7802, 7804, 7805, 7807 oil filling done.', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '10/07/2017',
        items: [
          { sr: 5, area: '7800', loop: 'N.A.', tag: 'A7801A', job: '', type: 'PROCESS REQMT', tech1: '', desc: 'TE449 -As per process requirement Element disconnected from its nipple union connections.', tech2: 'GAZ', status: 'OVER' }
        ]
      },
      {
        date: '12/11/2013',
        items: [
          { sr: 6, area: '7800', loop: 'N.A.', tag: 'A7801A', job: '', type: 'N.A.', tech1: '', desc: '-Visited to store and Metso metso make valve PV2303, PV2304, PV2325 valve spare part identified and its list prepared.', tech2: 'GAZ', status: 'OVER' }
        ]
      },
      {
        date: '21/05/2011',
        items: [
          { sr: 7, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: '', type: 'PROCESS REQMT', tech1: '', desc: 'As per process req. Pressure measurement of N2 line after NRV done(5.8bar).', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '20/05/2011',
        items: [
          { sr: 8, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: '', type: 'PROCESS REQMT', tech1: '', desc: 'As per process req. pressure measurement done(70bar) in Nitrogen line in A7801.', tech2: 'ALS', status: 'OVER' }
        ]
      },
      {
        date: '01/10/2009',
        items: [
          { sr: 9, area: '7800', loop: 'N.A.', tag: 'A7801A', job: 'SEC 7800 C/V pm to be done.', type: 'PM', tech1: 'JMD', desc: 'Permit not issued due to startup activity.', tech2: 'JMD', status: 'OVER' }
        ]
      },
      {
        date: '22/06/2007',
        items: [
          { sr: 10, area: 'N.A.', loop: 'N.A.', tag: 'A7801A', job: 'analyzer round to be taken', type: 'PM', tech1: 'JMD', desc: 'Routine analyzer round taken, except sec500/600. Also CO level was found high in sec700 ana. room.', tech2: 'JMD', status: 'OVER' }
        ]
      }
    ];

    function showReport() {
      const tagInput = document.getElementById('tagInput').value;
      if (!tagInput) {
        alert("Please enter a tag number");
        return;
      }

      document.getElementById('displayTag').innerText = tagInput;
      document.getElementById('report-container').classList.remove('hidden');
      document.getElementById('report-container').classList.add('flex');

      renderTable();
    }

    function resetView() {
      document.getElementById('tagInput').value = '';
      document.getElementById('report-container').classList.add('hidden');
      document.getElementById('report-container').classList.remove('flex');
    }

    function renderTable() {
      const tbody = document.getElementById('reportTableBody');
      tbody.innerHTML = '';

      historyData.forEach(group => {
        // 1. Date Header Row
        const headerRow = `
                    <tr class="gnfc-tr-group">
                        <td colspan="8" class="p-0">
                            <div class="gnfc-td-group">
                                <i class="ph-bold ph-calendar-blank"></i> ${group.date}
                            </div>
                        </td>
                    </tr>
                `;
        tbody.innerHTML += headerRow;

        // 2. Data Rows
        group.items.forEach(item => {
          const statusClass = item.status === 'OVER' ? 'gnfc-status over' : 'gnfc-status pending';

          const row = `
                        <tr class="gnfc-tr group">
                            <td class="gnfc-td text-center text-gray-500 typo-mono border-r border-gray-300">${item.sr}</td>
                            <td class="gnfc-td fw-bold text-center text-black border-r border-gray-300">${item.area}</td>

                            <td class="gnfc-td border-r border-gray-300">
                                <div class="font-14px text-gray-500">${item.loop}</div>
                                <div class="font-14px fw-bold text-blue-600 mt-1">${item.tag}</div>
                            </td>

                            <td class="gnfc-td border-r border-gray-300">
                                <div class="font-15px leading-tight mb-1 text-black" title="${item.job}">${item.job || '-'}</div>
                                <div class="border my-1"></div>
                                <span class="font-9px fw-semibold text-orange-600 text-upper bg-white px-2 rounded border border-gray-300">${item.type}</span>
                            </td>

                            <td class="gnfc-td text-center fw-bold text-gray-600 font-12px border-r border-gray-300">${item.tech1}</td>

                            <td class="gnfc-td font-16px text-black leading-relaxed border-r border-gray-300">
                                ${item.desc}
                            </td>

                            <td class="gnfc-td text-center border-r border-gray-300">
                                <span class="${statusClass}">
                                    ${item.status}
                                </span>
                            </td>

                            <td class="gnfc-td"></td>
                        </tr>
                    `;
          tbody.innerHTML += row;
        });
      });
    }
  </script>
  <script src="/src/js/emg_call_modal.js"></script>
  <script src="/src/js/pagination.js"></script>
</body>

</html>