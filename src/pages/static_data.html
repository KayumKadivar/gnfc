<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Static Data | GNFC</title>
  
  <link rel="stylesheet" href="/src/css/ios-fonts.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
          },
          colors: {
            'dark-bg': '#0f172a',
            'dark-panel': '#1e293b',
            'dark-border': '#334155',
            'dark-text': '#f8fafc',
            'dark-muted': '#94a3b8',
            'gnfc-blue': '#3b82f6',
            'gnfc-cyan': '#06b6d4',
            'gnfc-orange': '#f97316',
            'gnfc-green': '#10b981',
            'gnfc-red': '#ef4444',
          }
        }
      }
    }
  </script>

</head>

<body class="bg-dark-bg text-dark-text h-screen flex overflow-hidden selection:bg-gnfc-blue selection:text-white">

  <!-- Sidebar Container -->
  <div id="sidebar-container"></div>
  <script src="/src/js/sidebar.js"></script>
  <script>try { renderSidebar('technician_logbook'); } catch (e) { console.error(e); }</script>

  <main class="flex-1 flex flex-col h-screen overflow-hidden relative">
    
    <!-- Background Gradient Effect -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none z-0">
        <div class="absolute top-[-10%] right-[-5%] w-[500px] h-[500px] bg-gnfc-blue/5 rounded-full blur-[100px] animate-pulse"></div>
        <div class="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-gnfc-cyan/5 rounded-full blur-[120px]"></div>
    </div>

    <!-- Header -->
    <div id="header-container"></div>
    <script src="/src/js/header.js"></script>
    <script>
      // Function to parse query parameters
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      const systemName = getQueryParam('system') || 'System';
      const frequency = getQueryParam('freq') || 'Daily';
      const formattedSystem = systemName.replace(' DCS', '').replace(' ESD', '');

      renderHeader({
        title: "Acetic Acid Plant",
        breadcrumbs: [
          { label: "Technician Log", href: "technician_logbook.html" },
          { label: "Plant Detail", href: "plant_detail.html" },
          { label: "System Performance", href: `Sy_PM.html?system=${systemName}` },
          { label: "Static Data" } 
        ],
        backLink: `Sy_PM.html?system=${systemName}`
      });
    </script>

    <!-- Main Content Area -->
    <div class="flex-1 overflow-y-auto p-6 z-10 relative custom-scrollbar flex flex-col">
      
      <!-- Top Navigation Bar -->
      <div id="plant-nav-container" class="mb-6"></div>
      <script src="/src/js/plant_nav.js"></script>
      <script>renderPlantNav('sy_pm');</script>


      <!-- Static Data Panel -->
      <div class="glass-panel w-full rounded-xl overflow-hidden shadow-xl flex flex-col flex-1 max-h-full">
            
            <!-- Panel Header -->
            <div class="px-6 py-5 border-b border-dark-border bg-dark-panel flex justify-between items-center">
                <div>
                   <h2 class="text-xs font-bold text-gnfc-orange uppercase tracking-wider mb-1">Static Values</h2>
                   <h3 class="text-xl font-extrabold text-white flex items-center gap-2">
                      <span id="page-system-title">ACETIC ACID</span>
                      <i class="ph-bold ph-caret-right text-dark-muted text-sm"></i>
                      <span id="page-freq-title" class="text-gnfc-blue">DCS DAILY</span>
                   </h3>
                </div>
                <div class="flex gap-3">
                    <a href="#" onclick="window.history.back()" class="px-3 py-2 rounded-lg border border-dark-border text-dark-muted text-sm font-bold hover:bg-white/5 hover:text-white transition-colors">
                        Main
                    </a>
                    <button onclick="openModal('modal-add')" class="px-3 py-2 rounded-lg bg-gnfc-blue text-white text-sm font-bold hover:bg-blue-600 transition-colors shadow-lg shadow-blue-500/20 flex items-center gap-2">
                        <i class="ph-bold ph-plus"></i> Add
                    </button>
                </div>
            </div>

             <!-- Scrollable Table Area -->
            <div class="flex-1 overflow-auto custom-scrollbar">
                <table class="w-full custom-table border-collapse">
                    <thead class="sticky top-0 z-10">
                        <tr>
                            <th class="w-16 text-center">Sr</th>
                            <th class="w-1/3">Item</th>
                            <th class="w-1/4">Action</th>
                            <th class="w-1/4">Reference Value</th>
                            <th class="w-24 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="static-data-body">
                        <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
            
            <!-- Instructions Footer -->
            <div class="p-4 bg-dark-bg/50 border-t border-dark-border">
                <div class="flex items-start gap-4 p-3 rounded-lg border border-dark-border bg-dark-panel/50">
                    <div class="flex-1">
                        <h4 class="text-xs font-bold text-dark-muted uppercase mb-1">Instruction</h4>
                        <p class="text-sm text-dark-text leading-relaxed">Ensure all cabinet doors are securely closed after inspection. Validate temperature readings against local gauges if discrepancy > 2Â°C.</p> 
                    </div>
                    <button class="text-xs font-bold text-gnfc-blue hover:text-white px-3 py-1.5 rounded border border-gnfc-blue/30 hover:bg-gnfc-blue/10 transition-colors">
                        Edit
                    </button>
                </div>
            </div>

      </div>

    </div>
  </main>


  <!-- Add/Edit Modal -->
  <div class="modal micro-modal" id="modal-add" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
      <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        
        <header class="flex justify-between items-center mb-6">
          <h2 class="text-lg font-bold text-white flex items-center gap-2" id="modal-title">
             <i class="ph-bold ph-pencil-simple text-gnfc-blue"></i>
             <span id="modal-header-text">Add New Record</span>
          </h2>
          <button class="text-dark-muted hover:text-white transition-colors" aria-label="Close modal" data-micromodal-close>
             <i class="ph-bold ph-x text-lg"></i>
          </button>
        </header>
        
        <main class="space-y-4">
            <input type="hidden" id="edit-id">
            
            <div>
                <label class="block text-xs font-bold text-dark-muted uppercase mb-1.5">Item Description</label>
                <input type="text" id="input-item" class="w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2.5 text-sm text-white focus:border-gnfc-blue focus:ring-1 focus:ring-gnfc-blue/50 outline-none transition-all" placeholder="Enter item description">
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-xs font-bold text-dark-muted uppercase mb-1.5">Action</label>
                    <input type="text" id="input-action" class="w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2.5 text-sm text-white focus:border-gnfc-blue focus:ring-1 focus:ring-gnfc-blue/50 outline-none transition-all" placeholder="Optional action">
                </div>
                <div>
                    <label class="block text-xs font-bold text-dark-muted uppercase mb-1.5">Reference Value</label>
                    <input type="text" id="input-ref" class="w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2.5 text-sm text-white focus:border-gnfc-blue focus:ring-1 focus:ring-gnfc-blue/50 outline-none transition-all" placeholder="Optional reference">
                </div>
            </div>
            
        </main>

        <footer class="mt-8 flex justify-end gap-3 pt-4 border-t border-dark-border">
            <button class="px-4 py-2 rounded-lg border border-dark-border text-dark-muted text-sm font-bold hover:text-white hover:bg-white/5 transition-colors" data-micromodal-close>Cancel</button>
            <button onclick="saveRecord()" class="px-4 py-2 rounded-lg bg-gnfc-blue text-white text-sm font-bold hover:bg-blue-600 shadow-lg shadow-blue-500/20 transition-all">Save Record</button>
        </footer>

      </div>
    </div>
  </div>


  <script>
    // --- Initial Config ---
    MicroModal.init();
    
    // Set headers
    document.getElementById('page-system-title').textContent = formattedSystem.toUpperCase();
    document.getElementById('page-freq-title').textContent = `${formattedSystem} ${frequency}`.toUpperCase();


    // --- Mock Data Management ---
    // In a real app, this would fetch from an API based on system + freq
    let staticData = [
        { id: 1, item: "AC is running or not?", action: "", ref: "" },
        { id: 2, item: "All cabinet doors must be closed.", action: "", ref: "" },
        { id: 3, item: "Any BPS Fail", action: "Open cabinets.", ref: "" },
        { id: 4, item: "Cabinet room temperature.", action: "Alarm and Trend on DCS.", ref: "Below 30 DegC." },
        { id: 5, item: "DCS Alarm Printer.", action: "Paper available and Ribbon quality", ref: "" },
        { id: 6, item: "DCS system alarm.", action: "Sys Key on display.", ref: "" },
        { id: 7, item: "FAN running indication.", action: "Open cabinets.", ref: "" },
        { id: 8, item: "Is any wires are unterminated and untagged?", action: "To be Terminated OR removed.", ref: "No wire should be unterminated." },
    ];

    function renderTable() {
        const tbody = document.getElementById('static-data-body');
        tbody.innerHTML = '';
        
        staticData.forEach((row, index) => {
            const tr = document.createElement('tr');
            tr.className = "group transition-colors";
            tr.innerHTML = `
                <td class="text-center font-mono text-dark-muted text-xs">${index + 1}</td>
                <td class="font-medium text-white group-hover:text-gnfc-blue transition-colors">${row.item}</td>
                <td class="text-dark-muted">${row.action}</td>
                <td class="text-dark-muted font-mono text-xs">${row.ref}</td>
                <td class="text-center">
                    <button onclick="editRecord(${row.id})" class="p-1.5 rounded hover:bg-white/10 text-dark-muted hover:text-white transition-colors" title="Edit">
                        <i class="ph-bold ph-pencil-simple"></i>
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    // --- Modal Logic ---
    function openModal(id) {
        document.getElementById('modal-header-text').textContent = 'Add New Record';
        document.getElementById('edit-id').value = '';
        document.getElementById('input-item').value = '';
        document.getElementById('input-action').value = '';
        document.getElementById('input-ref').value = '';
        MicroModal.show(id);
    }

    function editRecord(id) {
        const record = staticData.find(r => r.id === id);
        if(!record) return;

        document.getElementById('modal-header-text').textContent = 'Edit Record';
        document.getElementById('edit-id').value = record.id;
        document.getElementById('input-item').value = record.item;
        document.getElementById('input-action').value = record.action;
        document.getElementById('input-ref').value = record.ref;
        
        MicroModal.show('modal-add');
    }

    function saveRecord() {
        const id = document.getElementById('edit-id').value;
        const item = document.getElementById('input-item').value;
        const action = document.getElementById('input-action').value;
        const ref = document.getElementById('input-ref').value;

        if(!item) {
            alert("Item description is required");
            return;
        }

        if(id) {
            // Update
            const index = staticData.findIndex(r => r.id == id);
            if(index !== -1) {
                staticData[index] = { ...staticData[index], item, action, ref };
            }
        } else {
            // Add
            const newId = staticData.length > 0 ? Math.max(...staticData.map(r => r.id)) + 1 : 1;
            staticData.push({ id: newId, item, action, ref });
        }

        renderTable();
        MicroModal.close('modal-add');
    }

    // --- Init ---
    renderTable();

  </script>
</body>
</html>
