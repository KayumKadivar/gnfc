<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GNFC | SY_PM Report Workspace</title>
  <link rel="stylesheet" href="/src/css/ios-fonts.css">
  <link rel="stylesheet" href="/src/css/typography.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="/src/js/tailwind_config.js"></script>

  <style>
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--app-bg, #0f1115); }
    ::-webkit-scrollbar-thumb { background: var(--app-border, #2a2e36); border-radius: 10px; }

    @media print {
      body>*:not(#print-preview-modal) {
        display: none !important;
      }

      #print-preview-modal {
        position: absolute !important;
        inset: 0 !important;
        display: block !important;
        background: #ffffff !important;
        z-index: 9999 !important;
      }

      #print-preview-modal>div:first-child {
        display: none !important;
      }

      #print-preview-modal>div:nth-child(2) {
        width: 100% !important;
        height: auto !important;
      }

      .print\:hidden {
        display: none !important;
      }

      .print\:p-0 {
        padding: 0 !important;
      }

      .print\:overflow-visible {
        overflow: visible !important;
      }

      .print\:bg-white {
        background: #ffffff !important;
      }
    }
  </style>
</head>

<body
  class="bg-dark-bg color-primary font-sans h-screen flex overflow-hidden selection:bg-gnfc-orange selection:text-white relative">

  <script src="/src/js/theme_manager.js"></script>
  <script src="/src/js/sidebar.js"></script>
  <script src="/src/js/header.js"></script>

  <div id="sidebar-container" class="relative z-20"></div>
  <script>
    try {
      renderSidebar('technician_logbook');
    } catch (error) {
      console.error(error);
    }
  </script>

  <main class="flex-1 flex flex-col overflow-hidden relative z-10">
    <div id="header-container"></div>

    <div class="flex-1 overflow-y-auto p-4 space-y-4 scroll-smooth bg-dark-bg">
      <div id="plant-nav-container"></div>
      <script src="/src/js/plant_nav.js"></script>
      <script>
        try {
          renderPlantNav('sy_pm');
        } catch (error) {
          console.error(error);
        }
      </script>

      <section class="rounded-xl border border-dark-border bg-dark-panel p-4 shadow-lg">
        <div class="flex justify-between items-start gap-4 flex-wrap">
          <div>
            <h2 id="report-context-heading" class="font-18px fw-bold color-primary">Report Context</h2>
            <p class="font-12px color-secondary mt-1">Generate, edit and manage report instances for selected
              system-frequency pair.</p>
          </div>

          <div class="flex gap-2 flex-wrap font-10px fw-bold uppercase tracking-wider">
            <span
              class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-dark-bg border border-dark-border color-label">
              System <strong id="report-chip-system" class="color-primary">-</strong>
            </span>
            <span
              class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-dark-bg border border-dark-border color-label">
              Frequency <strong id="report-chip-frequency" class="color-primary">-</strong>
            </span>
            <span
              class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-dark-bg border border-dark-border color-label">
              Reports <strong id="report-count" class="color-primary">0</strong>
            </span>
            <span
              class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-dark-bg border border-dark-border color-label">
              Static <strong id="report-static-count" class="color-primary">0</strong>
            </span>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mt-5">
          <button id="btn-go-static" type="button"
            class="inline-flex items-center gap-2 px-4 py-2 bg-dark-header hover:bg-dark-border color-primary font-12px fw-bold rounded-lg transition-all border border-dark-border active:scale-95">
            <i class="ph-bold ph-database font-14px"></i> Static Data
          </button>

          <button id="btn-view-instruction" type="button"
            class="inline-flex items-center gap-2 px-4 py-2 bg-dark-header hover:bg-dark-border color-primary font-12px fw-bold rounded-lg transition-all border border-dark-border active:scale-95">
            <i class="ph-bold ph-info font-14px"></i> Instructions
          </button>

          <button id="btn-blank-format" type="button"
            class="inline-flex items-center gap-2 px-4 py-2 bg-dark-header hover:bg-dark-border color-primary font-12px fw-bold rounded-lg transition-all border border-dark-border active:scale-95">
            <i class="ph-bold ph-printer font-14px"></i> Blank Format
          </button>

          <button id="btn-generate-report" type="button"
            class="inline-flex items-center gap-2 px-4 py-2 bg-gnfc-orange hover:bg-amber-600 text-white font-12px fw-bold rounded-lg transition-all shadow-lg shadow-gnfc-orange/20 active:scale-95">
            <i class="ph-bold ph-plus-circle font-14px"></i> Generate Report
          </button>
        </div>
      </section>

      <section class="grid grid-cols-1 xl:grid-cols-12 gap-4">
        <div class="xl:col-span-3 rounded-xl border border-dark-border bg-dark-panel p-4 shadow-lg min-h-[560px] flex flex-col">
          <h3 class="font-14px fw-bold color-primary">Report History</h3>
          <p class="font-11px color-label mt-1 mb-3">Select a report to view/edit.</p>
          <div id="report-list" class="flex-1 overflow-y-auto pr-1 space-y-2"></div>
        </div>

        <div class="xl:col-span-9 rounded-xl border border-dark-border bg-dark-panel shadow-lg overflow-hidden flex flex-col min-h-[560px]">
          <div class="px-4 py-3 border-b border-dark-border bg-dark-header flex items-center justify-between gap-3">
            <h3 class="font-14px fw-bold color-primary flex items-center gap-2">
              <i class="ph-fill ph-note-pencil color-orange"></i>
              Report Editor
            </h3>
            <span id="report-editor-meta" class="font-10px typo-mono color-label">-</span>
          </div>

          <div id="report-editor-container" class="flex-1 overflow-auto p-4 bg-dark-bg/30"></div>

          <div class="px-4 py-3 border-t border-dark-border bg-dark-header/70 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3">
            <div class="flex items-center flex-wrap gap-3">
              <label class="font-10px fw-bold uppercase tracking-wider color-label flex items-center gap-2">
                Checked By 1
                <input id="report-checked-1" type="text" placeholder="PBS"
                  class="bg-dark-bg border border-dark-border rounded px-2 py-1 font-12px color-primary focus:border-gnfc-orange focus:outline-none uppercase typo-mono w-20" />
              </label>
              <label class="font-10px fw-bold uppercase tracking-wider color-label flex items-center gap-2">
                Checked By 2
                <input id="report-checked-2" type="text" placeholder="PNV"
                  class="bg-dark-bg border border-dark-border rounded px-2 py-1 font-12px color-primary focus:border-gnfc-orange focus:outline-none uppercase typo-mono w-20" />
              </label>
            </div>

            <div class="flex items-center gap-2 flex-wrap">
              <button id="btn-cancel-report" type="button"
                class="inline-flex items-center gap-2 px-4 py-2 bg-dark-header hover:bg-dark-border color-primary font-12px fw-bold rounded-lg transition-all border border-dark-border active:scale-95">
                Cancel
              </button>

              <button id="btn-delete-report" type="button"
                class="inline-flex items-center gap-2 px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-500 border border-red-500/30 font-12px fw-bold rounded-lg transition-all active:scale-95">
                <i class="ph-bold ph-trash font-14px"></i>
                Delete
              </button>

              <button id="btn-save-report" type="button"
                class="inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white font-12px fw-bold rounded-lg transition-all shadow-lg shadow-emerald-900/20 active:scale-95">
                <i class="ph-bold ph-floppy-disk font-14px"></i>
                Save Changes
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <div id="report-instruction-modal" class="fixed inset-0 z-50 hidden opacity-0 pointer-events-none transition-opacity duration-200" aria-hidden="true">
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" data-close-modal="true"></div>
    <div class="relative w-full max-w-2xl m-4 mx-auto bg-dark-panel border border-dark-border rounded-xl shadow-2xl flex flex-col max-h-[90vh]">
      <div class="px-5 py-4 border-b border-dark-border bg-dark-header rounded-t-xl flex items-center justify-between">
        <h3 class="font-14px fw-bold color-primary uppercase tracking-wide">Work Instruction</h3>
        <button type="button" data-close-modal="true" class="color-label hover-color-primary transition-colors">
          <i class="ph-bold ph-x font-18px pointer-events-none"></i>
        </button>
      </div>
      <div class="p-5 overflow-y-auto">
        <div id="report-instruction-text" class="color-primary whitespace-pre-wrap leading-relaxed font-14px"></div>
      </div>
      <div class="px-5 py-3 border-t border-dark-border bg-dark-header/70 rounded-b-xl flex justify-between items-center">
        <div id="report-instruction-updated" class="font-10px color-label typo-mono">-</div>
        <button type="button" data-close-modal="true"
          class="px-4 py-2 bg-dark-panel border border-dark-border color-primary font-12px fw-bold rounded hover:bg-dark-border transition-colors">Close</button>
      </div>
    </div>
  </div>

  <div id="print-preview-modal" class="fixed inset-0 z-[100] hidden opacity-0 pointer-events-none transition-opacity duration-200" aria-hidden="true">
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" data-close-modal="true"></div>

    <div class="relative w-full h-full flex flex-col bg-white">
      <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200 bg-gray-50 print:hidden">
        <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
          <i class="ph-bold ph-printer text-gray-500"></i> Print Preview
        </h3>
        <div class="flex items-center gap-3">
          <button id="btn-print-modal" type="button"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-lg transition-colors flex items-center gap-2">
            <i class="ph-bold ph-printer"></i> Print
          </button>
          <button type="button" class="p-2 text-gray-500 hover:text-gray-800 transition-colors" data-close-modal="true">
            <i class="ph-bold ph-x text-xl"></i>
          </button>
        </div>
      </div>

      <div id="print-preview-content" class="flex-1 overflow-auto p-8 bg-gray-100 print:p-0 print:overflow-visible print:bg-white"></div>
    </div>
  </div>

  <script src="/src/js/emg_call_modal.js"></script>
  <script type="module" src="/src/js/sy_pm/page_report.js"></script>
</body>

</html>
