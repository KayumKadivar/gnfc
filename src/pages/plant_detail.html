<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plant Detail | GNFC</title>
  <link rel="stylesheet" href="/src/css/ios-fonts.css">
  <link rel="stylesheet" href="/src/css/typography.css">
  <link rel="stylesheet" href="/src/css/modal-ui.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
  <style>
    #plant-table tbody tr {
      transition: background-color .18s ease;
    }

    .elog-chip {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 10px;
      font-weight: 700;
      background: #f3f4f6;
      border: 1px solid #e5e7eb;
      color: #374151;
      border-radius: 4px;
      padding: 0.2rem 0.5rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    html.dark .elog-chip {
      background: #111217;
      border-color: #2c3235;
      color: #9ca3af;
    }
  </style>
  <script src="/src/js/tailwind_config.js"></script>
</head>

<body
  class="bg-dark-bg color-primary font-sans h-screen flex overflow-hidden selection:bg-gnfc-blue selection:text-white">

  <script src="/src/js/theme_manager.js"></script>
  <script src="/src/js/sidebar.js"></script>
  <script src="/src/js/header.js"></script>
  <div id="sidebar-container"></div>
  <script>
    try {
      renderSidebar('technician_logbook');
    } catch (e) {
      // noop
    }
  </script>

  <main class="theme-contrast-lock flex-1 flex flex-col overflow-hidden">

    <div id="header-container"></div>
    <script>
      renderHeader({
        title: "Plant Logbook",
        breadcrumbs: [
          { label: "Technician Log", href: "/src/pages/technician_logbook.html" },
          { label: "Plant Detail" }
        ],
        backLink: "/src/pages/technician_logbook.html"
      });
    </script>


    <div class="flex-1 overflow-y-auto p-4 bg-dark-bg">
      <!-- Top Navigation Bar -->
      <div id="plant-nav-container"></div>
      <script src="/src/js/plant_nav.js"></script>
      <script> try { renderPlantNav('logs'); } catch (e) { } </script>


      <!-- Unified Action Toolbar -->
      <div class="p-4 bg-dark-panel border-b border-dark-border space-y-4 my-4">

        <div class="flex flex-wrap justify-between gap-4">

          <!-- Left: Period Selector & Plant Info -->
          <div class="flex items-center gap-4 w-full xl:w-auto">
            <div class="flex bg-dark-bg p-0.5 rounded-sm border border-dark-border overflow-x-auto max-w-full">
              <button id="btn-tomorrow" onclick="switchView(this, 'tomorrow')"
                class="tab-btn px-3 py-1 font-14px fw-bold color-secondary hover-color-white rounded-[2px] transition-all">Tomorrow</button>
              <button id="btn-today" onclick="switchView(this, 'today')"
                class="tab-btn px-3 py-1 font-14px fw-bold color-orange bg-dark-panel shadow-sm rounded-[2px] transition-all">Today</button>
              <button id="btn-prev" onclick="switchView(this, 'prev')"
                class="tab-btn px-3 py-1 font-14px fw-bold color-secondary hover-color-white rounded-[2px] transition-all">PrevDay</button>
              <div class="w-px bg-dark-border mx-1 my-1"></div>
              <button id="btn-weekly" onclick="switchView(this, 'weekly')"
                class="tab-btn px-3 py-1 font-14px fw-bold color-secondary hover-color-white rounded-[2px] transition-all">Weekly</button>
              <button id="btn-monthly" onclick="switchView(this, 'monthly')"
                class="tab-btn px-3 py-1 font-14px fw-bold color-secondary hover-color-white rounded-[2px] transition-all">Monthly</button>
            </div>
          </div>

          <!-- Right: Actions & Tools -->
          <div class="flex flex-wrap items-center gap-3 w-full xl:w-auto justify-end">

            <button onclick="AddLogModal.open()"
              class=" items-center gap-2 px-4 py-1.5 bg-gnfc-blue hover:bg-gnfc-blue/80 text-white font-14px fw-bold rounded-md shadow-lg shadow-emerald-900/20 transition-all hover:scale-105 active:scale-95">
              <i class="ph-bold ph-plus"></i> Add Job
            </button>

            <button onclick="window.location.href='/src/pages/shift_logbook.html?view=assigned_today'"
              class=" items-center gap-2 px-4 py-1.5 bg-gnfc-blue hover:bg-gnfc-blue/80 text-white font-14px fw-bold rounded-md shadow-lg shadow-emerald-900/20 transition-all hover:scale-105 active:scale-95">
              Assign Today
            </button>

            <button onclick="window.location.href='/src/pages/shift_logbook.html?view=assigned_tomorrow'"
              class=" items-center gap-2 px-4 py-1.5 bg-gnfc-blue hover:bg-gnfc-blue/80 text-white font-14px fw-bold rounded-md shadow-lg shadow-emerald-900/20 transition-all hover:scale-105 active:scale-95">
              Assign Tomorrow
            </button>

            <script>
              // Hide assigned job cards for Technician role
              (function () {
                const role = localStorage.getItem('userRole') || 'technician';
                if (role === 'technician') {
                  const section = document.getElementById('assigned-jobs-section');
                  if (section) section.style.display = 'none';
                }
              })();
            </script>

            <div class="h-6 w-px bg-dark-border mx-1 hidden sm:block"></div>

            <!-- Tools Group -->
            <div class="flex items-center gap-2">
              <button id="toggle-pending-btn" onclick="togglePendingMode()"
                class="flex items-center gap-2 px-3 py-1.5 bg-dark-bg hover:bg-dark-header border border-dark-border color-secondary hover-color-orange font-14px fw-bold rounded-sm transition-colors"
                title="Show Pending Logs">
                <i class="ph-bold ph-clock"></i> Pending
              </button>

              <button id="job-reminder-btn" onclick="openReminderModal()"
                class="flex items-center gap-2 px-3 py-1.5 bg-dark-bg hover:bg-dark-header border border-dark-border color-secondary hover:text-purple-400 font-14px fw-bold rounded-sm transition-colors"
                title="Job Planner / Reminders">
                <i class="ph-bold ph-calendar-check"></i> Planner
              </button>

              <button id="acknowledge-btn" onclick="openAckModal()" style="display:none;"
                class="flex items-center gap-2 px-3 py-1.5 bg-amber-500/10 hover:bg-amber-500/20 border border-amber-500/30 text-amber-500 font-14px fw-bold rounded-sm transition-colors animate-pulse">
                <i class="ph-bold ph-warning"></i> Acknowledge
              </button>
            </div>


          </div>
        </div>


      </div>



      <!-- Filters Drawer (Collapsible) -->
      <div id="job-filter-bar" class="hidden bg-dark-header border-b border-dark-border p-3 transition-all">
        <div class="flex flex-col md:flex-row items-center gap-4 font-14px">
          <div class="flex items-center gap-2">
            <span class="color-secondary typo-mono text-upper">Range:</span>
            <input type="date" id="start-date" onchange="applyFilters()"
              class="bg-dark-bg border border-dark-border text-white rounded-sm px-2 py-1 outline-none focus:border-gnfc-blue">
            <span class="color-secondary">-</span>
            <input type="date" id="end-date" onchange="applyFilters()"
              class="bg-dark-bg border border-dark-border text-white rounded-sm px-2 py-1 outline-none focus:border-gnfc-blue">
          </div>

          <div class="flex items-center gap-2 flex-1">
            <span class="color-secondary typo-mono text-upper">Type:</span>
            <select id="job-type-select" onchange="applyFilters()"
              class="bg-dark-bg border border-dark-border text-white rounded-sm px-2 py-1 outline-none focus:border-gnfc-blue min-w-[150px]">
              <option value="">All Jobs</option>
            </select>
          </div>

          <button onclick="toggleJobFilter()" class="color-secondary hover-color-white"><i
              class="ph-bold ph-x"></i></button>
        </div>
      </div>

      <div id="dynamic-view-container"
        class="bg-white dark:bg-dark-panel border border-slate-200 dark:border-dark-border rounded-sm flex flex-col">
        <div
          class="px-4 py-2 border-b border-slate-200 dark:border-dark-border flex justify-between items-center bg-slate-50 dark:bg-dark-panel">
          <div class="flex items-center gap-2">
            <i class="ph-fill ph-table text-blue-600 dark:color-blue"></i>
            <span id="view-title" class="font-15px fw-bold text-slate-800 dark:color-primary">Today Log Book</span>
            <span id="record-count"
              class="ml-2 font-13px bg-slate-200 dark:bg-dark-bg border border-slate-300 dark:border-dark-border px-2 py-0.5 rounded text-slate-600 dark:color-secondary typo-mono">0
              Records</span>
          </div>

          <div class="flex items-center gap-3">
            <div class="relative">
              <i class="ph ph-magnifying-glass absolute left-2 top-1/2 -translate-y-1/2 color-secondary font-14px"></i>
              <input type="text" id="table-search" placeholder="Search logs..."
                onkeyup="plantLogTable.setSearch(this.value)"
                class="bg-white dark:bg-dark-bg border border-slate-300 dark:border-dark-border color-primary font-14px rounded-sm pl-7 pr-3 py-1 focus:border-blue-500 dark:focus:border-gnfc-blue focus:outline-none w-48 transition-colors">
            </div>
            <span id="view-date" class="font-14px typo-mono color-blue dark:color-orange">--.--.----</span>
          </div>
        </div>

        <div class="overflow-x-auto flex-1">
          <table id="plant-table" class="w-full text-left border-collapse">
            <thead class="bg-slate-100 hover:bg-slate-200 dark:bg-dark-header ">
              <tr
                class="font-13px fw-bold color-secondary text-upper ls-widest text-center border-b border-slate-200 dark:border-dark-border">
                <th rowspan="2" class="border-r border-dark-border p-2 w-12 cursor-pointer transition-colors"
                  onclick="plantLogTable.sort('sr')">Sr <i class="ph-fill ph-caret-up-down text-[8px] ml-1"></i></th>
                <th rowspan="2" class="border-r border-dark-border p-2 w-20 cursor-pointer transition-colors"
                  onclick="plantLogTable.sort('area')">Area <i class="ph-fill ph-caret-up-down text-[8px] ml-1"></i>
                </th>
                <th class="border-r border-b px-3 py-2 w-40 border-dark-border cursor-pointer transition-colors"
                  onclick="plantLogTable.sort('tag')">Loop No <i class="ph-fill ph-caret-up-down text-[8px] ml-1"></i>
                </th>
                <th
                  class="border-r border-b px-3 py-2 min-w-[200px] border-dark-border fw-black cursor-pointer transition-colors"
                  onclick="plantLogTable.sort('jobType')">Job <i class="ph-fill ph-caret-up-down text-[8px] ml-1"></i>
                </th>
                <th rowspan="2" class="border-r border-dark-border p-2 w-16 cursor-pointer transition-colors"
                  onclick="plantLogTable.sort('tech')">Tech</th>
                <th rowspan="2" class="border-r border-dark-border p-2 min-w-[300px] transition-colors">
                  Description
                </th>
                <th rowspan="2" class="border-r border-dark-border p-2 w-24 cursor-pointer transition-colors"
                  onclick="plantLogTable.sort('engineer')">Tech/Eng</th>
                <th rowspan="2" class="border-r border-dark-border p-2 w-28 relative group/th">
                  <div class="flex items-center justify-between cursor-pointer transition-colors p-1 rounded"
                    onclick="plantLogTable.sort('status')">
                    <span>Status</span>
                  </div>
                  <button onclick="toggleStatusFilter(event)"
                    class="absolute top-5 right-6 color-secondary hover-color-blue focus:outline-none p-1 rounded hover:bg-white/5">
                    <i class="ph-bold ph-funnel font-14px"></i>
                  </button>
                  <div id="status-filter-dropdown"
                    class="hidden absolute top-14 right-0 w-28 bg-white dark:bg-dark-panel border border-slate-200 dark:border-dark-border shadow-xl rounded-sm z-50 flex flex-col py-1">
                  </div>
                </th>
                <th rowspan="2" class="p-2 min-w-[120px] transition-colors">Remarks</th>
                <th rowspan="2" class="p-2 w-10 transition-colors" title="Add To History">H</th>
              </tr>
              <tr
                class="font-13px fw-bold text-slate-500 dark:color-secondary text-upper ls-widest text-center border-b border-slate-200 dark:border-dark-border">
                <th class="border-r border-dark-border p-2 transition-colors">Tag No</th>
                <th class="border-r border-dark-border p-2 transition-colors">Type of Job</th>
              </tr>
            </thead>
            <tbody id="plantTableBody" class="font-14px typo-mono"></tbody>
          </table>
        </div>

        <div id="plant-table-pagination" class="px-4 pb-4 bg-white dark:bg-dark-panel"></div>
      </div>
    </div>
  </main>

  <div id="job-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell">
      <div class="gnfc-modal-header">
        <h3 id="job-modal-title" class="gnfc-modal-title">Assign Job</h3>
        <button onclick="closeJobModal()" class="gnfc-modal-close"><i class="ph-bold ph-x text-lg"></i></button>
      </div>
      <form id="job-modal-form">
        <div class="gnfc-modal-body gnfc-modal-body--tight" style="overflow-y:auto;">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            <div>
              <label class="gnfc-modal-label">Date (Server)</label>
              <input id="job-date" type="text" readonly class="gnfc-modal-input">
            </div>
            <div>
              <label class="gnfc-modal-label">Technician</label>
              <select id="job-tech" class="gnfc-modal-input"></select>
            </div>
            <div>
              <label class="gnfc-modal-label">Or Enter Tech</label>
              <input id="job-tech-custom" type="text" placeholder="Optional" class="gnfc-modal-input">
            </div>
            <div>
              <label class="gnfc-modal-label">Loop</label>
              <select id="job-loop" onchange="filterTagsForLoop()" class="gnfc-modal-input"></select>
            </div>
            <div>
              <label class="gnfc-modal-label">Tag</label>
              <select id="job-tag" class="gnfc-modal-input"></select>
            </div>
            <div>
              <label class="gnfc-modal-label">Area</label>
              <select id="job-area" class="gnfc-modal-input"></select>
            </div>
            <div>
              <label class="gnfc-modal-label">Type Of Job</label>
              <select id="job-type" class="gnfc-modal-input"></select>
            </div>
            <div>
              <label class="gnfc-modal-label">Type Of Inst</label>
              <select id="job-inst" class="gnfc-modal-input"></select>
            </div>
            <div class="md:col-span-3">
              <label class="gnfc-modal-label">Description</label>
              <textarea id="job-desc" rows="3" class="gnfc-modal-input" placeholder="Enter job description"></textarea>
            </div>
          </div>

          <div id="job-modal-ojr" class="border border-dark-border rounded-sm overflow-hidden mt-4">
            <div class="px-3 py-2 border-b border-dark-border bg-dark-panel font-13px fw-bold color-blue text-upper">
              Operation Job Register / Weekly Pending</div>
            <div class="max-h-32 overflow-auto divide-y divide-dark-border" id="ojr-pending-list"></div>
          </div>
        </div>

        <div class="gnfc-modal-footer">
          <button type="button" onclick="closeJobModal()"
            class="gnfc-modal-btn gnfc-modal-btn-secondary">Cancel</button>
          <button type="submit" class="gnfc-modal-btn gnfc-modal-btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>

  <div id="edit-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell">

      <!-- Header -->
      <div class="gnfc-modal-header">
        <div>
          <h3 class="gnfc-modal-title">Edit Assigned Job</h3>
          <p class="gnfc-modal-subtitle">JOB ID: <span id="edit-job-id-display" style="color:#3b82f6;">--</span></p>
        </div>
        <button onclick="closeEditModal()" class="gnfc-modal-close">
          <i class="ph-bold ph-x text-lg"></i>
        </button>
      </div>

      <form id="edit-modal-form" class="flex flex-col h-full">
        <input id="edit-job-id" type="hidden">

        <!-- Scrollable Content -->
        <div class="gnfc-modal-body" style="max-height:70vh;">
          <div class="space-y-6">

            <!-- Top Context Strip -->
            <div
              class="grid grid-cols-3 gap-px bg-dark-border border border-dark-border rounded-sm overflow-hidden font-14px shadow-sm">
              <div class="bg-[#22252b] p-3">
                <label class="gnfc-modal-label">Date</label>
                <input id="edit-job-date" type="text" readonly
                  class="w-full bg-transparent border-none p-0 color-primary typo-mono focus:ring-0 cursor-default">
              </div>
              <div class="bg-[#22252b] p-3 border-l border-dark-border">
                <label class="gnfc-modal-label">Assigned To</label>
                <input id="edit-job-assigned-to" type="text" readonly
                  class="w-full bg-transparent border-none p-0 color-blue fw-bold focus:ring-0 cursor-default">
              </div>
              <div class="bg-[#22252b] p-3 border-l border-dark-border">
                <label class="gnfc-modal-label">Assigned By</label>
                <input id="edit-job-by" type="text" readonly
                  class="w-full bg-transparent border-none p-0 color-primary focus:ring-0 cursor-default">
              </div>
            </div>

            <!-- Job Details Card -->
            <div class="space-y-2">
              <h4 class="font-13px fw-bold color-blue text-upper ls-widest flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-gnfc-blue"></span> Job Context
              </h4>
              <div class="bg-[#1e2126] border border-dark-border rounded-sm p-4 space-y-4 shadow-sm">
                <div>
                  <label class="gnfc-modal-label">Job Summary</label>
                  <textarea id="edit-job-summary" rows="1" readonly
                    class="gnfc-modal-input resize-none fw-medium"></textarea>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                  <div>
                    <label class="gnfc-modal-label">Date</label>
                    <input id="edit-job-detail-date" type="text" readonly class="gnfc-modal-input"
                      style="color:#94a3b8;">
                  </div>
                  <div class="md:col-span-2">
                    <label class="gnfc-modal-label">Loop / Tag</label>
                    <input id="edit-job-loop-tag" type="text" readonly class="gnfc-modal-input"
                      style="color:#3b82f6;font-family:monospace;font-weight:500;">
                  </div>
                  <div>
                    <label class="gnfc-modal-label">Type</label>
                    <input id="edit-job-type" type="text" readonly class="gnfc-modal-input">
                    <input id="edit-job-inst" type="hidden">
                  </div>
                </div>
              </div>
            </div>

            <!-- Execution / Update Section -->
            <div class="space-y-3">
              <h4 class="font-13px fw-bold color-green text-upper ls-widest flex items-center gap-2">
                <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span> Execution Update
              </h4>

              <div class="space-y-4">
                <div>
                  <label class="gnfc-modal-label" style="color:#f1f5f9;">Description / Remarks <span
                      style="color:#f87171;">*</span></label>
                  <textarea id="edit-job-desc" rows="4" class="gnfc-modal-input typo-mono leading-relaxed"
                    style="font-size:0.875rem;" placeholder="Enter detailed job description..."></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label class="gnfc-modal-label">Current Status</label>
                    <div class="relative">
                      <select id="edit-job-status" class="gnfc-modal-input"
                        style="padding-left:0.75rem;padding-right:2rem;height:2.25rem;font-weight:700;appearance:none;cursor:pointer;">
                        <option value="IN PROGRESS">IN PROGRESS</option>
                        <option value="✓ OVER">✓ OVER</option>
                        <option value="HOLD">HOLD</option>
                      </select>
                      <i
                        class="ph-bold ph-caret-down absolute right-3 top-1/2 -translate-y-1/2 color-secondary pointer-events-none"></i>
                    </div>
                  </div>
                  <div>
                    <label class="gnfc-modal-label">Extra Duty (Hrs)</label>
                    <input id="edit-job-extra-hours" type="number" min="0" step="1" class="gnfc-modal-input"
                      style="height:2.25rem;font-family:monospace;">
                  </div>
                </div>

                <div class="pt-4 border-t border-dark-border/50">
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <label class="gnfc-modal-label">Technician</label>
                      <div class="relative">
                        <select id="edit-job-tech" class="gnfc-modal-input" style="appearance:none;"></select>
                        <i
                          class="ph-bold ph-caret-down absolute right-2 top-1/2 -translate-y-1/2 color-secondary font-13px pointer-events-none"></i>
                      </div>
                    </div>
                    <div>
                      <label class="gnfc-modal-label">Engineer</label>
                      <div class="relative">
                        <select id="edit-job-engineer" class="gnfc-modal-input" style="appearance:none;"></select>
                        <i
                          class="ph-bold ph-caret-down absolute right-2 top-1/2 -translate-y-1/2 color-secondary font-13px pointer-events-none"></i>
                      </div>
                    </div>
                    <div class="hidden">
                      <select id="edit-job-area"></select>
                    </div>
                  </div>
                </div>

                <!-- Emergency Toggle -->
                <div class="pt-2 flex justify-end">
                  <label class="flex items-center gap-3 cursor-pointer group select-none">
                    <span class="font-14px fw-bold color-secondary group-hover-color-orange transition-colors">Emergency
                      Call</span>
                    <div class="relative">
                      <input id="edit-job-emergency" type="checkbox" class="sr-only peer">
                      <div
                        class="w-9 h-5 bg-dark-border peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-gnfc-orange/90 transition-colors">
                      </div>
                    </div>
                  </label>
                </div>

              </div>
            </div>

            <div id="edit-warning"
              class="hidden p-3 bg-amber-500/10 border border-amber-500/30 rounded-sm flex items-start gap-2">
              <i class="ph-bold ph-warning text-amber-500 mt-0.5"></i>
              <p class="font-14px text-amber-200" id="edit-warning-text"></p>
            </div>

          </div>
        </div>

        <!-- Footer -->
        <div class="gnfc-modal-footer">
          <button type="button" onclick="closeEditModal()"
            class="gnfc-modal-btn gnfc-modal-btn-secondary">Cancel</button>
          <button type="submit" class="gnfc-modal-btn gnfc-modal-btn-primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <div id="remark-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell gnfc-modal-shell--medium">
      <div class="gnfc-modal-header">
        <h3 class="gnfc-modal-title">Remarks</h3>
        <button onclick="closeRemarkModal()" class="gnfc-modal-close"><i class="ph-bold ph-x text-lg"></i></button>
      </div>
      <form id="remark-modal-form">
        <div class="gnfc-modal-body gnfc-modal-body--tight">
          <input id="remark-job-id" type="hidden">
          <div id="remark-history"
            class="max-h-40 overflow-auto border border-dark-border rounded-sm divide-y divide-dark-border">
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
            <div>
              <label class="gnfc-modal-label">Remark Type</label>
              <select id="remark-type" class="gnfc-modal-input">
                <option value="engineer">Engineer</option>
                <option value="executive">Executive</option>
              </select>
            </div>
            <label class="flex items-center gap-2 font-14px mt-5">
              <input id="remark-ack-tech" type="checkbox" class="accent-gnfc-blue">
              Ack by Technician
            </label>
            <label class="flex items-center gap-2 font-14px mt-5">
              <input id="remark-ack-eng" type="checkbox" class="accent-gnfc-blue">
              Ack by Engineer
            </label>
          </div>
          <div class="mt-3">
            <label class="gnfc-modal-label">New Remark</label>
            <textarea id="remark-text" rows="3" class="gnfc-modal-input"
              placeholder="Remarks are append-only"></textarea>
          </div>
        </div>
        <div class="gnfc-modal-footer">
          <button type="button" onclick="closeRemarkModal()"
            class="gnfc-modal-btn gnfc-modal-btn-secondary">Close</button>
          <button type="submit" class="gnfc-modal-btn gnfc-modal-btn-primary">Append Remark</button>
        </div>
      </form>
    </div>
  </div>

  <div id="ack-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell gnfc-modal-shell--medium">
      <div class="gnfc-modal-header">
        <h3 class="gnfc-modal-title">Pending Remark Acknowledgement</h3>
        <button onclick="closeAckModal()" class="gnfc-modal-close"><i class="ph-bold ph-x text-lg"></i></button>
      </div>
      <div class="gnfc-modal-body gnfc-modal-body--tight">
        <div id="ack-list"
          class="max-h-64 overflow-auto border border-dark-border rounded-sm divide-y divide-dark-border">
        </div>
      </div>
      <div class="gnfc-modal-footer">
        <button type="button" onclick="closeAckModal()" class="gnfc-modal-btn gnfc-modal-btn-secondary">Close</button>
        <button type="button" onclick="acknowledgeSelectedRemarks()"
          class="gnfc-modal-btn gnfc-modal-btn-primary">Acknowledge Selected</button>
      </div>
    </div>
  </div>

  <div id="reminder-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell gnfc-modal-shell--medium">
      <div class="gnfc-modal-header">
        <h3 class="gnfc-modal-title">Job Planner / ISO14001 Due Jobs</h3>
        <button onclick="closeReminderModal()" class="gnfc-modal-close"><i class="ph-bold ph-x text-lg"></i></button>
      </div>
      <div id="reminder-list" class="gnfc-modal-body gnfc-modal-body--tight" style="overflow-y:auto;"></div>
      <div class="gnfc-modal-footer">
        <button type="button" onclick="closeReminderModal()"
          class="gnfc-modal-btn gnfc-modal-btn-secondary">Close</button>
      </div>
    </div>
  </div>

  <script src="/src/js/pagination.js"></script>
  <script src="/src/js/plant_log_core.js"></script>

  <!-- Add To History — Type Selection Modal (Fig 5.32.1) -->
  <div id="history-type-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell gnfc-modal-shell--narrow">
      <div class="gnfc-modal-header" style="justify-content:center;text-align:center;display:block;">
        <h3 class="gnfc-modal-title">METHANOL-1</h3>
        <p class="gnfc-modal-subtitle">Add To History</p>
      </div>
      <div class="gnfc-modal-body gnfc-modal-body--tight" style="text-align:center;">
        <p class="font-14px fw-bold color-secondary text-upper ls-wide mb-4">Select History Type</p>
        <div class="flex items-center justify-center gap-3">
          <button onclick="selectHistoryType('system')" class="gnfc-modal-btn gnfc-modal-btn-primary">System
            History</button>
          <button onclick="selectHistoryType('general')" class="gnfc-modal-btn gnfc-modal-btn-success">General
            History</button>
        </div>
      </div>
      <div class="gnfc-modal-footer" style="justify-content:center;">
        <button onclick="closeHistoryTypeModal()" class="gnfc-modal-btn gnfc-modal-btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- General History Form Modal (Fig 5.33) -->
  <div id="general-history-modal" class="gnfc-modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="gnfc-modal-shell">
      <div class="gnfc-modal-header">
        <div>
          <h3 class="gnfc-modal-title">Add To History</h3>
          <span class="gnfc-modal-subtitle">METHANOL-1</span>
        </div>
        <div class="flex items-center gap-2">
          <span id="history-type-badge"
            class="font-13px px-2 py-0.5 bg-emerald-500/10 text-emerald-400 border border-emerald-500/30 rounded-sm fw-bold">General
            History</span>
          <button onclick="closeGeneralHistoryModal()" class="gnfc-modal-close">
            <i class="ph-bold ph-x text-lg"></i>
          </button>
        </div>
      </div>

      <div class="gnfc-modal-body gnfc-modal-body--tight" style="overflow-y:auto;max-height:70vh;">
        <p class="font-14px fw-bold color-green mb-4">New Record</p>

        <!-- Row 1: Date/Loop, InstTag, Type of Job, Type of Inst -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
          <div class="space-y-1">
            <label class="gnfc-modal-label">Date</label>
            <input type="date" id="hist-date" class="gnfc-modal-input">
            <label class="gnfc-modal-label" style="margin-top:0.25rem;">Loop Name</label>
            <input type="text" id="hist-loop" readonly class="gnfc-modal-input" style="color:#94a3b8;">
          </div>
          <div class="space-y-1">
            <label class="gnfc-modal-label">InstTag</label>
            <select id="hist-insttag" class="gnfc-modal-input">
              <option>DCS</option>
              <option>TRANSMITTER</option>
              <option>CONTROL VALVE</option>
              <option>SWITCH</option>
              <option>ANALYZER</option>
              <option>OTHERS</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="gnfc-modal-label">Type of Job</label>
            <select id="hist-jobtype" class="gnfc-modal-input">
              <option>PROCESS REQMT</option>
              <option>CMS JOB</option>
              <option>PM JOB</option>
              <option>BREAKDOWN</option>
              <option>N.A.</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="gnfc-modal-label">Type of Inst</label>
            <input type="text" id="hist-insttype" readonly class="gnfc-modal-input" style="color:#94a3b8;">
          </div>
        </div>

        <!-- Job Description -->
        <div class="space-y-1 mt-4">
          <label class="gnfc-modal-label" style="color:#f87171;">Job Description</label>
          <textarea id="hist-desc" rows="4" class="gnfc-modal-input typo-mono leading-relaxed"></textarea>
        </div>

        <!-- Row 2: Job Status, Tech Name, Eng, Area -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-4">
          <div class="space-y-1">
            <label class="gnfc-modal-label">Job Status</label>
            <select id="hist-status" class="gnfc-modal-input">
              <option>OVER</option>
              <option>IN PROGRESS</option>
              <option>U/P</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="gnfc-modal-label">Tech Name</label>
            <select id="hist-tech" class="gnfc-modal-input">
              <option>BPB</option>
              <option>PBS</option>
              <option>NRK</option>
              <option>SHC</option>
              <option>NHP</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="gnfc-modal-label">Eng</label>
            <select id="hist-eng" class="gnfc-modal-input">
              <option>SHC</option>
              <option>MAJ</option>
              <option>CKV</option>
              <option>MDM</option>
            </select>
          </div>
          <div class="space-y-1">
            <label class="gnfc-modal-label">Area</label>
            <select id="hist-area" class="gnfc-modal-input">
              <option>METH</option>
              <option>FA</option>
              <option>AA</option>
              <option>DCS</option>
              <option>UTIL</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="gnfc-modal-footer">
        <button onclick="closeGeneralHistoryModal()" class="gnfc-modal-btn gnfc-modal-btn-secondary">Cancel</button>
        <button onclick="addToHistory()" class="gnfc-modal-btn gnfc-modal-btn-primary">Add</button>
      </div>
    </div>
  </div>
  </div>


  <script src="/src/js/emg_call_modal.js"></script>
  <script src="/src/js/elogbook_store.js"></script>
  <script src="/src/js/elogbook_plant_flow.js"></script>
  <script src="/src/js/add_log_modal.js"></script>
</body>

</html>